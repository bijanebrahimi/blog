<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Routines Excluded</title><link href="http://bijanebrahimi.github.io/blog/" rel="alternate"></link><link href="http://bijanebrahimi.github.io/blog/feeds/all.atom.xml" rel="self"></link><id>http://bijanebrahimi.github.io/blog/</id><updated>2017-11-27T20:50:00+03:30</updated><entry><title>Fine Tuned Shell Scripting and Bash Automated Testing System Using Bats</title><link href="http://bijanebrahimi.github.io/blog/fine-tuned-shell-scripting-and-bash-automated-testing-system-using-bats.html" rel="alternate"></link><published>2017-11-27T20:50:00+03:30</published><updated>2017-11-27T20:50:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-11-27:/blog/fine-tuned-shell-scripting-and-bash-automated-testing-system-using-bats.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Last Saturday, I gave a brief presentation on shell scripting and bats, a bash
based automated testing system at &lt;a href="http://mashhadbug.org"&gt;MashhadBUG&lt;/a&gt;. Please Don't forget to check
the references at the end of the post.&lt;/p&gt;
&lt;h1&gt;Table of Contents&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;PART I: &lt;a href="http://blackskyresearch.net/shelltables.txt"&gt;Shell Tables&lt;/a&gt; by Isaac Levy&lt;/li&gt;
&lt;li&gt;PART II: &lt;a href="http://www.nycbug.org/index.cgi?action=view&amp;amp;id=10640"&gt;The 3 finger claw …&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Last Saturday, I gave a brief presentation on shell scripting and bats, a bash
based automated testing system at &lt;a href="http://mashhadbug.org"&gt;MashhadBUG&lt;/a&gt;. Please Don't forget to check
the references at the end of the post.&lt;/p&gt;
&lt;h1&gt;Table of Contents&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;PART I: &lt;a href="http://blackskyresearch.net/shelltables.txt"&gt;Shell Tables&lt;/a&gt; by Isaac Levy&lt;/li&gt;
&lt;li&gt;PART II: &lt;a href="http://www.nycbug.org/index.cgi?action=view&amp;amp;id=10640"&gt;The 3 finger claw technique&lt;/a&gt; by Isaac Levy&lt;/li&gt;
&lt;li&gt;PART III: &lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Bash Automated Testing System&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;PART I: &lt;a href="http://blackskyresearch.net/shelltables.txt"&gt;Shell Tables&lt;/a&gt; by Isaac Levy&lt;/h1&gt;
&lt;h2&gt;I/O Redirection&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ prog &amp;gt; file       &lt;span class="c1"&gt;# direct stdout to file&lt;/span&gt;
$ prog &amp;gt;&amp;gt; file      &lt;span class="c1"&gt;# append stdout to file&lt;/span&gt;
$ prog &amp;lt; file       &lt;span class="c1"&gt;# take standard input from file&lt;/span&gt;
$ &amp;lt; file prog
$ prog1 &lt;span class="p"&gt;|&lt;/span&gt; prog2 &lt;span class="c1"&gt;# connect standard output of p1 to standard input of p2&lt;/span&gt;
$ prog &lt;span class="s"&gt;&amp;lt;&amp;lt;HEREDOC    # H&lt;/span&gt;ereDoc
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Commands&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ prog1&lt;span class="p"&gt;;&lt;/span&gt; prog2      &lt;span class="c1"&gt;# command terminator&lt;/span&gt;
$ prog1 &lt;span class="p"&gt;&amp;amp;&lt;/span&gt; prog2     &lt;span class="c1"&gt;# like ; but doesn&amp;#39;t wait for p1 to finish&lt;/span&gt;
$ &lt;span class="sb"&gt;`&lt;/span&gt;prog1&lt;span class="sb"&gt;`&lt;/span&gt;       &lt;span class="c1"&gt;# run command, output replaces&lt;/span&gt;
$ &lt;span class="o"&gt;(&lt;/span&gt;prog1&lt;span class="o"&gt;)&lt;/span&gt;       &lt;span class="c1"&gt;# run command in sub-shell&lt;/span&gt;
$ &lt;span class="o"&gt;{&lt;/span&gt;prog1&lt;span class="o"&gt;}&lt;/span&gt;       &lt;span class="c1"&gt;# run command in current-shell&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Shell Scripts&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;...&lt;span class="nv"&gt;$9&lt;/span&gt;         &lt;span class="c1"&gt;# positional arguments&lt;/span&gt;
&lt;span class="nv"&gt;$#&lt;/span&gt;          &lt;span class="c1"&gt;# total number of arguments&lt;/span&gt;
&lt;span class="nv"&gt;$*&lt;/span&gt;          &lt;span class="c1"&gt;# all the arguments as a single string (expanded/double-quoted)&lt;/span&gt;
&lt;span class="nv"&gt;$@&lt;/span&gt;          &lt;span class="c1"&gt;# all the arguments as separate strings (expanded/double-quoted)&lt;/span&gt;
&lt;span class="nv"&gt;$$&lt;/span&gt;          &lt;span class="c1"&gt;# pid of current shell process&lt;/span&gt;
&lt;span class="nv"&gt;$!&lt;/span&gt;          &lt;span class="c1"&gt;# pid of last background command&lt;/span&gt;
&lt;span class="nv"&gt;$?&lt;/span&gt;          &lt;span class="c1"&gt;# exit status of previous command&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Evaluation and Substitution of Shell Variables&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;$var&lt;/span&gt;            &lt;span class="c1"&gt;# Value of &amp;#39;var&amp;#39;&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;var&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;          &lt;span class="c1"&gt;# useful if alphanumerics follows&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;var&lt;/span&gt;&lt;span class="p"&gt;-thing&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;        &lt;span class="c1"&gt;# &amp;#39;var&amp;#39; if defined, O.W thing&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;var&lt;/span&gt;&lt;span class="k"&gt;:-&lt;/span&gt;&lt;span class="nv"&gt;word&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;        &lt;span class="c1"&gt;# &amp;#39;var&amp;#39; if exists and isn&amp;#39;t null, O.W &amp;#39;word&amp;#39;&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;var&lt;/span&gt;&lt;span class="p"&gt;:=word&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;        &lt;span class="c1"&gt;# like above but changes var&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;var&lt;/span&gt;&lt;span class="p"&gt;:?message&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;     &lt;span class="c1"&gt;# abort if var doesn&amp;#39;t exist or is null&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;var&lt;/span&gt;&lt;span class="p"&gt;:+word&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;        &lt;span class="c1"&gt;# returns word if var exists and isn&amp;#39;t null&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;PART II: &lt;a href="http://www.nycbug.org/index.cgi?action=view&amp;amp;id=10640"&gt;The 3 finger claw technique&lt;/a&gt; by Isaac Levy&lt;/h1&gt;
&lt;h1&gt;The Original 3 short functions&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;shout&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt;: &lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;2&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; 
barf&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; shout &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; 100&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; 
safe&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; barf &lt;span class="s2"&gt;&amp;quot;cannot &lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;The 3 short functions&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;yell&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt;: &lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;2&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;
die&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; yell &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; 111&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;
try&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; die &lt;span class="s2"&gt;&amp;quot;cannot &lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Using The 3 finger claw technique&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/sh&lt;/span&gt;

yell&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt;: &lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;2&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;
die&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; yell &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; 111&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;
try&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; die &lt;span class="s2"&gt;&amp;quot;cannot &lt;/span&gt;&lt;span class="nv"&gt;$*&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;# using it&lt;/span&gt;
try &lt;span class="nb"&gt;cd&lt;/span&gt; /some/place
tar tar xzvfp /another/place/stuff.tbz

&lt;span class="nb"&gt;exit&lt;/span&gt; 0
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;PART III: &lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Bash Automated Testing System&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Bats is a &lt;a href="http://testanything.org/"&gt;TAP&lt;/a&gt;-compliant testing framework for Bash. It provides a simple way to verify that the UNIX programs you write behave as expected.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;&lt;a href="http://testanything.org/"&gt;TAP&lt;/a&gt;: Test Anything Protocol&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;TAP, the Test Anything Protocol, is a simple text-based interface between testing modules in a test harness. TAP started life as part of the test harness for Perl but now has implementations in C, C++, Python, PHP, Perl, Java, JavaScript, and others.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;1..4
ok 1 - Input file opened
not ok 2 - First line of the input valid
ok 3 - Read the rest of the file
not ok 4 - Summarized correctly # TODO Not written yet
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;&lt;a href="http://testanything.org/"&gt;TAP&lt;/a&gt;: Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://testanything.org/tap-specification.html"&gt;TAP Specification&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://testanything.org/producers.html"&gt;TAP Producers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://testanything.org/consumers.html"&gt;TAP Consumers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://testanything.org/history.html"&gt;TAP History&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Bash Automated Testing System&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Bats is a &lt;a href="http://testanything.org/"&gt;TAP&lt;/a&gt;-compliant testing framework for Bash. It provides a simple way to verify that the UNIX programs you write behave as expected.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Installation&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git clone https://github.com/sstephenson/bats.git
$ &lt;span class="nb"&gt;cd&lt;/span&gt; bats
$ doas ./install.sh /usr/local
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Writing Tests&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ cat test.bats
&lt;span class="c1"&gt;#!/usr/bin/env bats&lt;/span&gt;

@test &lt;span class="s2"&gt;&amp;quot;addition using bc&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="nv"&gt;result&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; 2+2 &lt;span class="p"&gt;|&lt;/span&gt; bc&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
  &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$result&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; -eq &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

@test &lt;span class="s2"&gt;&amp;quot;addition using dc&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="nv"&gt;result&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt; 2+p &lt;span class="p"&gt;|&lt;/span&gt; dc&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
  &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$result&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; -eq &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Running Tests&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ bats test.bats 
 ✓ addition using bc
 ✓ addition using dc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;WAIT, THAT'S NOT TAP COMPLIANT&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Running Tests (Cont.)&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ bats --tap test.bats
1..2
ok &lt;span class="m"&gt;1&lt;/span&gt; addition using bc
ok &lt;span class="m"&gt;2&lt;/span&gt; addition using dc
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Writing Tests; &lt;code&gt;run&lt;/code&gt; command&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;@test &lt;span class="s2"&gt;&amp;quot;invoking foo with a nonexistent file prints an error&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  run foo nonexistent_filename
  &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$status&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; -eq &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;
  &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$output&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;foo: no such file &amp;#39;nonexistent_filename&amp;#39;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Writing Tests; &lt;code&gt;load&lt;/code&gt; command&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;load test_helper
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Writing Tests; &lt;code&gt;skip&lt;/code&gt; command&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ cat test.bats
@test &lt;span class="s2"&gt;&amp;quot;A test I don`t want to execute for now&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  skip &lt;span class="s2"&gt;&amp;quot;This command will return zero soon, but not now&amp;quot;&lt;/span&gt;
  run foo
  &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$status&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; -eq &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Running Skiped Tests&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ bats test.bats
 - A &lt;span class="nb"&gt;test&lt;/span&gt; I don&lt;span class="sb"&gt;`&lt;/span&gt;t want to execute &lt;span class="k"&gt;for&lt;/span&gt; now &lt;span class="o"&gt;(&lt;/span&gt;skipped: This &lt;span class="nb"&gt;command&lt;/span&gt; will &lt;span class="k"&gt;return&lt;/span&gt; zero soon, but not now&lt;span class="o"&gt;)&lt;/span&gt;

&lt;span class="m"&gt;1&lt;/span&gt; test, &lt;span class="m"&gt;0&lt;/span&gt; failures, &lt;span class="m"&gt;1&lt;/span&gt; skipped
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Writing Tests; &lt;code&gt;skip&lt;/code&gt; command (Cont.)&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;@test &lt;span class="s2"&gt;&amp;quot;A test which should run only when bar is foo&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="o"&gt;[&lt;/span&gt; foo !&lt;span class="o"&gt;=&lt;/span&gt; bar &lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; skip &lt;span class="s2"&gt;&amp;quot;foo isn&amp;#39;t bar&amp;quot;&lt;/span&gt;

  run foo
  &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$status&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; -eq &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Writing Tests; &lt;code&gt;setup&lt;/code&gt; and &lt;code&gt;teardown&lt;/code&gt; functions&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;setup&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;
  /* Initialization call per &lt;span class="nb"&gt;test&lt;/span&gt; calls */
&lt;span class="o"&gt;}&lt;/span&gt;

teardown&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;
  /* Finalization call per &lt;span class="nb"&gt;test&lt;/span&gt; calls */
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Continues Integration Support&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ cat .travis.yml
before_install:
  - sudo add-apt-repository ppa:duggan/bats --yes
  - sudo apt-get update -qq
  - sudo apt-get install -qq bats
script:
  - bats test/bats
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Helpers&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/ztombol/bats-support"&gt;bats-support&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/ztombol/bats-assert"&gt;bats-assert&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Definitely your own helper&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a href="https://github.com/sstephenson/bats"&gt;Bats&lt;/a&gt;: Helpers (Cont)&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;config&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="nv"&gt;command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
  &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;read&lt;/span&gt; line&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    command+&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;-c &amp;#39;&lt;/span&gt;&lt;span class="nv"&gt;$line&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39; &amp;quot;&lt;/span&gt;
  &lt;span class="k"&gt;done&lt;/span&gt;
  bash -c &lt;span class="s2"&gt;&amp;quot;prog &lt;/span&gt;&lt;span class="nv"&gt;$command&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
remote&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
 &lt;span class="nv"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
 &lt;span class="nv"&gt;command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="p"&gt;@:&lt;/span&gt;&lt;span class="nv"&gt;2&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
 ssh &lt;span class="nv"&gt;$host&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nb"&gt;typeset&lt;/span&gt; -f&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;; &lt;/span&gt;&lt;span class="nv"&gt;$command&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Resources&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.nycbug.org/index.cgi?action=view&amp;amp;id=10640"&gt;shell-fu, NYCBUG (2016)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.engineyard.com/blog/bats-test-command-line-tools"&gt;How to use Bats to test your command line tools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://medium.com/@pimterry/testing-your-shell-scripts-with-bats-abfca9bdc5b9"&gt;Testing Your Shell Scripts, with Bats&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://softwaretester.info/automate-bash-testing-with-bats/"&gt;Automate Bash testing with Bats&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://rnowling.github.io/software/engineering/2017/02/04/testing-cli-apps-with-bats.html"&gt;Testing CLI Apps with Bats&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Shell"></category><category term="Scripting"></category><category term="Bats"></category><category term="sh"></category></entry><entry><title>Smallest and Longest Manpage you ever read</title><link href="http://bijanebrahimi.github.io/blog/smallest-and-longest-manpage-you-ever-read.html" rel="alternate"></link><published>2017-10-31T21:53:00+03:30</published><updated>2017-10-31T21:53:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-10-31:/blog/smallest-and-longest-manpage-you-ever-read.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Recently I asked a question on OpenSD IRC channel which led to a question
entirely different. What's the smallest/longest manpage you ever read?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ find /usr/local/share/man -type f -exec wc -l &lt;span class="o"&gt;{}&lt;/span&gt; &lt;span class="se"&gt;\;&lt;/span&gt;  &lt;span class="p"&gt;|&lt;/span&gt; sort
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;On OpenBSD 6.2, the smallest is &lt;a href="https://man.openbsd.org/dcphy.4"&gt;dcphy(4)&lt;/a&gt; with 23 lines and the …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Recently I asked a question on OpenSD IRC channel which led to a question
entirely different. What's the smallest/longest manpage you ever read?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ find /usr/local/share/man -type f -exec wc -l &lt;span class="o"&gt;{}&lt;/span&gt; &lt;span class="se"&gt;\;&lt;/span&gt;  &lt;span class="p"&gt;|&lt;/span&gt; sort
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;On OpenBSD 6.2, the smallest is &lt;a href="https://man.openbsd.org/dcphy.4"&gt;dcphy(4)&lt;/a&gt; with 23 lines and the longest
(by far distance) is &lt;a href="https://man.openbsd.org/perltoc.1"&gt;perltoc(1)&lt;/a&gt; with 33106 lines. But what's the longest
manpage you actually read?&lt;/p&gt;</content><category term="OpenBSD"></category><category term="Manpages"></category></entry><entry><title>My OpenBSD Setup</title><link href="http://bijanebrahimi.github.io/blog/my-openbsd-setup.html" rel="alternate"></link><published>2017-10-31T21:15:00+03:30</published><updated>2017-10-31T21:15:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-10-31:/blog/my-openbsd-setup.html</id><summary type="html">&lt;p&gt;Today, I'm going to write about my personal experience with OpenBSD on my Laptop
as an OpenBSD user. I think I will come back day to day and update this blog
post, but currently the following topics are coeverd:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#network-managers"&gt;Network Managers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#filesystem-auto-mount"&gt;Filesystem Auto-Mount&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#desktop-notification-daemon"&gt;Desktop Notification Daemon&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TODO:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Android Integration&lt;/li&gt;
&lt;li&gt;Development …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Today, I'm going to write about my personal experience with OpenBSD on my Laptop
as an OpenBSD user. I think I will come back day to day and update this blog
post, but currently the following topics are coeverd:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#network-managers"&gt;Network Managers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#filesystem-auto-mount"&gt;Filesystem Auto-Mount&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#desktop-notification-daemon"&gt;Desktop Notification Daemon&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TODO:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Android Integration&lt;/li&gt;
&lt;li&gt;Development Environment&lt;/li&gt;
&lt;li&gt;Themes&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Network Managers&lt;/h2&gt;
&lt;p&gt;I found &lt;a href="https://github.com/akpoff/netctl/"&gt;netctl(8)&lt;/a&gt; an interesting utility.It supports
network configuration separated based on Location or nwids (for wifi networks).
The manpage is complete (OpenBSD Style) but the idea is simple and clear. netctl
keeps &lt;a href="http://man.openbsd.org/hostname.if.5"&gt;hostname.if(5)&lt;/a&gt; configuration files categorized in &lt;code&gt;/etc/hostname.d&lt;/code&gt;
directory by loaction or nwids and then symlink them into &lt;code&gt;/etc&lt;/code&gt; at startup
or by switching to different locations on-demand:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ls -lR /etc/hostname.*
/etc/hostname.run0 -&amp;gt; /etc/hostname.d/nwids/BlackHole.nwid

/etc/hostname.d:
nwids

/etc/hostname.d/nwids:
BlackHole.nwid
ZWLan.nwid
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;But if you liked netctl, you might also wanted to read &lt;a href="http://vincentdelft.be/post/post_20171023"&gt;Vincet's Blog Post, 
Network Manager Control for OpenBSD&lt;/a&gt;. Basically &lt;a href="https://sourceforge.net/p/nmctl/code/ci/master/tree/"&gt;nmctl&lt;/a&gt; is an improved
version of rewritten in python. He also has an intergration section with openbox
(if you're using).&lt;/p&gt;
&lt;h2&gt;Filesystem Auto-Mount&lt;/h2&gt;
&lt;p&gt;To automatically mount USB storage sticks, &lt;a href="http://man.openbsd.org/hotplugd.8"&gt;hotplugd(8)&lt;/a&gt; is the tool. You can
find a nice example script in the manual or here at &lt;a href="https://www.tumfatig.net/20110903/automount-usb-stick-on-openbsd/"&gt;TuM'Fatig Automount USB
stick on OpenBSD&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ doas rcctl &lt;span class="nb"&gt;enable&lt;/span&gt; hotplugd
$ cat /etc/hotplug/attach
&lt;span class="c1"&gt;#!/bin/sh&lt;/span&gt;

&lt;span class="nv"&gt;DEVCLASS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;
&lt;span class="nv"&gt;DEVNAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$2&lt;/span&gt;
&lt;span class="nv"&gt;MOUNTROOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/mnt&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;DEBUG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1

&lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nv"&gt;$DEVCLASS&lt;/span&gt; in
2&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# disk devices&lt;/span&gt;
        &lt;span class="nv"&gt;disklabel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;/sbin/disklabel &lt;span class="nv"&gt;$DEVNAME&lt;/span&gt; 2&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; /usr/bin/sed -n &lt;span class="s1"&gt;&amp;#39;/^disk: /s/^disk: //p&amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$DEBUG&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; logger -i &lt;span class="s2"&gt;&amp;quot;hotplugd discovered DISKLABEL &lt;/span&gt;&lt;span class="nv"&gt;$disklabel&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nv"&gt;$disklabel&lt;/span&gt; in
        &lt;span class="s2"&gt;&amp;quot;SCSI disk&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
                &lt;span class="nv"&gt;slices&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;/sbin/disklabel &lt;span class="nv"&gt;$DEVNAME&lt;/span&gt; 2&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
                sed -n &lt;span class="s1"&gt;&amp;#39;/^ *[abd-z]: /s/^ *\([abd-z]\):.*/\1/p&amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt; slice in &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;slices&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$DEBUG&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; logger -i &lt;span class="s2"&gt;&amp;quot;hotplugd attaching SLICE &lt;/span&gt;&lt;span class="nv"&gt;$slice&lt;/span&gt;&lt;span class="s2"&gt; of DEVICE &lt;/span&gt;&lt;span class="nv"&gt;$DEVNAME&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
                        &lt;span class="o"&gt;[&lt;/span&gt; ! -d &lt;span class="nv"&gt;$MOUNTROOT&lt;/span&gt;/&lt;span class="nv"&gt;$DEVNAME$slice&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; mkdir -p -m &lt;span class="m"&gt;1777&lt;/span&gt; &lt;span class="nv"&gt;$MOUNTROOT&lt;/span&gt;/&lt;span class="nv"&gt;$DEVNAME$slice&lt;/span&gt;
                        mount /dev/&lt;span class="nv"&gt;$DEVNAME$slice&lt;/span&gt; &lt;span class="nv"&gt;$MOUNTROOT&lt;/span&gt;/&lt;span class="nv"&gt;$DEVNAME$slice&lt;/span&gt;
                &lt;span class="k"&gt;done&lt;/span&gt;
                &lt;span class="p"&gt;;;&lt;/span&gt;
        &lt;span class="k"&gt;esac&lt;/span&gt;
        &lt;span class="p"&gt;;;&lt;/span&gt;
3&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# network devices; requires hostname.$DEVNAME&lt;/span&gt;
        sh /etc/netstart &lt;span class="nv"&gt;$DEVNAME&lt;/span&gt;
        &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;span class="k"&gt;esac&lt;/span&gt;
$ doas chmod &lt;span class="m"&gt;0755&lt;/span&gt; /etc/hotplug/attach
$ doas rcctl restart hotplugd
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;that's it. The next time you plug a USB stick, it will be mount at
&lt;code&gt;/mnt/${dev}${slice}&lt;/code&gt; directory automatically.&lt;/p&gt;
&lt;h2&gt;Desktop Notification Daemon&lt;/h2&gt;
&lt;p&gt;If you're using window managers like &lt;a href="https://i3wm.org"&gt;i3wm&lt;/a&gt;, you might find &lt;a href="https://dunst-project.org/"&gt;dunst&lt;/a&gt; a
perfect simple notification daemon which is avilable as package:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ doas pkg_add dunst
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That's it. you don't need to enable anything since sending any message to
notification, automatically runs dunst. To test the notification:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ notify-send helloWorld
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And here's a simple configuration I picked from a quick search on the web:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ cat ~/.config/dunst/dunstrc 
&lt;span class="o"&gt;[&lt;/span&gt;global&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;font&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; Iosevka Term 11

&lt;span class="c1"&gt;# Allow a small subset of html markup:&lt;/span&gt;
&lt;span class="c1"&gt;#   &amp;lt;b&amp;gt;bold&amp;lt;/b&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;#   &amp;lt;i&amp;gt;italic&amp;lt;/i&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;#   &amp;lt;s&amp;gt;strikethrough&amp;lt;/s&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;#   &amp;lt;u&amp;gt;underline&amp;lt;/u&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# For a complete reference see&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;http://developer.gnome.org/pango/stable/PangoMarkupFormat.html&amp;gt;.&lt;/span&gt;
&lt;span class="c1"&gt;# If markup is not allowed, those tags will be stripped out of the&lt;/span&gt;
&lt;span class="c1"&gt;# message.&lt;/span&gt;
&lt;span class="nv"&gt;allow_markup&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; yes
&lt;span class="nv"&gt;plain_text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; no

&lt;span class="c1"&gt;# The format of the message.  Possible variables are:&lt;/span&gt;
&lt;span class="c1"&gt;#   %a  appname&lt;/span&gt;
&lt;span class="c1"&gt;#   %s  summary&lt;/span&gt;
&lt;span class="c1"&gt;#   %b  body&lt;/span&gt;
&lt;span class="c1"&gt;#   %i  iconname (including its path)&lt;/span&gt;
&lt;span class="c1"&gt;#   %I  iconname (without its path)&lt;/span&gt;
&lt;span class="c1"&gt;#   %p  progress value if set ([  0%] to [100%]) or nothing&lt;/span&gt;
&lt;span class="c1"&gt;# Markup is allowed&lt;/span&gt;
&lt;span class="nv"&gt;format&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;b&amp;gt;%s&amp;lt;/b&amp;gt;\n%b&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# Sort messages by urgency.&lt;/span&gt;
&lt;span class="nv"&gt;sort&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; no

&lt;span class="c1"&gt;# Show how many messages are currently hidden (because of geometry).&lt;/span&gt;
&lt;span class="nv"&gt;indicate_hidden&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; yes

&lt;span class="c1"&gt;# Alignment of message text.&lt;/span&gt;
&lt;span class="c1"&gt;# Possible values are &amp;quot;left&amp;quot;, &amp;quot;center&amp;quot; and &amp;quot;right&amp;quot;.&lt;/span&gt;
&lt;span class="nv"&gt;alignment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; center

&lt;span class="c1"&gt;# The frequency with wich text that is longer than the notification&lt;/span&gt;
&lt;span class="c1"&gt;# window allows bounces back and forth.&lt;/span&gt;
&lt;span class="c1"&gt;# This option conflicts with &amp;quot;word_wrap&amp;quot;.&lt;/span&gt;
&lt;span class="c1"&gt;# Set to 0 to disable.&lt;/span&gt;
&lt;span class="nv"&gt;bounce_freq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 0

&lt;span class="c1"&gt;# Show age of message if message is older than show_age_threshold&lt;/span&gt;
&lt;span class="c1"&gt;# seconds.&lt;/span&gt;
&lt;span class="c1"&gt;# Set to -1 to disable.&lt;/span&gt;
&lt;span class="nv"&gt;show_age_threshold&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; -1

&lt;span class="c1"&gt;# Split notifications into multiple lines if they don&amp;#39;t fit into&lt;/span&gt;
&lt;span class="c1"&gt;# geometry.&lt;/span&gt;
&lt;span class="nv"&gt;word_wrap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; yes

&lt;span class="c1"&gt;# Ignore newlines &amp;#39;\n&amp;#39; in notifications.&lt;/span&gt;
&lt;span class="nv"&gt;ignore_newline&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; no

&lt;span class="c1"&gt;# Hide duplicate&amp;#39;s count and stack them&lt;/span&gt;
&lt;span class="nv"&gt;stack_duplicates&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; yes
&lt;span class="nv"&gt;hide_duplicates_count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; yes


&lt;span class="c1"&gt;# The geometry of the window:&lt;/span&gt;
&lt;span class="c1"&gt;#   [{width}]x{height}[+/-{x}+/-{y}]&lt;/span&gt;
&lt;span class="c1"&gt;# The geometry of the message window.&lt;/span&gt;
&lt;span class="c1"&gt;# The height is measured in number of notifications everything else&lt;/span&gt;
&lt;span class="c1"&gt;# in pixels.  If the width is omitted but the height is given&lt;/span&gt;
&lt;span class="c1"&gt;# (&amp;quot;-geometry x2&amp;quot;), the message window expands over the whole screen&lt;/span&gt;
&lt;span class="c1"&gt;# (dmenu-like).  If width is 0, the window expands to the longest&lt;/span&gt;
&lt;span class="c1"&gt;# message displayed.  A positive x is measured from the left, a&lt;/span&gt;
&lt;span class="c1"&gt;# negative from the right side of the screen.  Y is measured from&lt;/span&gt;
&lt;span class="c1"&gt;# the top and down respectevly.&lt;/span&gt;
&lt;span class="c1"&gt;# The width can be negative.  In this case the actual width is the&lt;/span&gt;
&lt;span class="c1"&gt;# screen width minus the width defined in within the geometry option.&lt;/span&gt;
&lt;span class="c1"&gt;#geometry = &amp;quot;250x50-40+40&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;geometry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;300x50-15+49&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# Shrink window if it&amp;#39;s smaller than the width.  Will be ignored if&lt;/span&gt;
&lt;span class="c1"&gt;# width is 0.&lt;/span&gt;
&lt;span class="nv"&gt;shrink&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; no

&lt;span class="c1"&gt;# The transparency of the window.  Range: [0; 100].&lt;/span&gt;
&lt;span class="c1"&gt;# This option will only work if a compositing windowmanager is&lt;/span&gt;
&lt;span class="c1"&gt;# present (e.g. xcompmgr, compiz, etc.).&lt;/span&gt;
&lt;span class="nv"&gt;transparency&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 5

&lt;span class="c1"&gt;# Don&amp;#39;t remove messages, if the user is idle (no mouse or keyboard input)&lt;/span&gt;
&lt;span class="c1"&gt;# for longer than idle_threshold seconds.&lt;/span&gt;
&lt;span class="c1"&gt;# Set to 0 to disable.&lt;/span&gt;
&lt;span class="nv"&gt;idle_threshold&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 0

&lt;span class="c1"&gt;# Which monitor should the notifications be displayed on.&lt;/span&gt;
&lt;span class="nv"&gt;monitor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 0

&lt;span class="c1"&gt;# Display notification on focused monitor.  Possible modes are:&lt;/span&gt;
&lt;span class="c1"&gt;#   mouse: follow mouse pointer&lt;/span&gt;
&lt;span class="c1"&gt;#   keyboard: follow window with keyboard focus&lt;/span&gt;
&lt;span class="c1"&gt;#   none: don&amp;#39;t follow anything&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;quot;keyboard&amp;quot; needs a windowmanager that exports the&lt;/span&gt;
&lt;span class="c1"&gt;# _NET_ACTIVE_WINDOW property.&lt;/span&gt;
&lt;span class="c1"&gt;# This should be the case for almost all modern windowmanagers.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# If this option is set to mouse or keyboard, the monitor option&lt;/span&gt;
&lt;span class="c1"&gt;# will be ignored.&lt;/span&gt;
&lt;span class="nv"&gt;follow&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; none

&lt;span class="c1"&gt;# Should a notification popped up from history be sticky or timeout&lt;/span&gt;
&lt;span class="c1"&gt;# as if it would normally do.&lt;/span&gt;
&lt;span class="nv"&gt;sticky_history&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; yes

&lt;span class="c1"&gt;# Maximum amount of notifications kept in history&lt;/span&gt;
&lt;span class="nv"&gt;history_length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 15

&lt;span class="c1"&gt;# Display indicators for URLs (U) and actions (A).&lt;/span&gt;
&lt;span class="nv"&gt;show_indicators&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; no

&lt;span class="c1"&gt;# The height of a single line.  If the height is smaller than the&lt;/span&gt;
&lt;span class="c1"&gt;# font height, it will get raised to the font height.&lt;/span&gt;
&lt;span class="c1"&gt;# This adds empty space above and under the text.&lt;/span&gt;
&lt;span class="nv"&gt;line_height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 3

&lt;span class="c1"&gt;# Draw a line of &amp;quot;separatpr_height&amp;quot; pixel height between two&lt;/span&gt;
&lt;span class="c1"&gt;# notifications.&lt;/span&gt;
&lt;span class="c1"&gt;# Set to 0 to disable.&lt;/span&gt;
&lt;span class="nv"&gt;separator_height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 2

&lt;span class="c1"&gt;# Padding between text and separator.&lt;/span&gt;
&lt;span class="nv"&gt;padding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 6

&lt;span class="c1"&gt;# Horizontal padding.&lt;/span&gt;
&lt;span class="nv"&gt;horizontal_padding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 6

&lt;span class="c1"&gt;# Define a color for the separator.&lt;/span&gt;
&lt;span class="c1"&gt;# possible values are:&lt;/span&gt;
&lt;span class="c1"&gt;#  * auto: dunst tries to find a color fitting to the background;&lt;/span&gt;
&lt;span class="c1"&gt;#  * foreground: use the same color as the foreground;&lt;/span&gt;
&lt;span class="c1"&gt;#  * frame: use the same color as the frame;&lt;/span&gt;
&lt;span class="c1"&gt;#  * anything else will be interpreted as a X color.&lt;/span&gt;
&lt;span class="nv"&gt;separator_color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; frame

&lt;span class="c1"&gt;# Print a notification on startup.&lt;/span&gt;
&lt;span class="c1"&gt;# This is mainly for error detection, since dbus (re-)starts dunst&lt;/span&gt;
&lt;span class="c1"&gt;# automatically after a crash.&lt;/span&gt;
&lt;span class="nv"&gt;startup_notification&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;

&lt;span class="c1"&gt;# dmenu path.&lt;/span&gt;
&lt;span class="nv"&gt;dmenu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /usr/bin/dmenu -p dunst:

&lt;span class="c1"&gt;# Browser for opening urls in context menu.&lt;/span&gt;
&lt;span class="nv"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /usr/bin/firefox -new-tab

&lt;span class="c1"&gt;# Align icons left/right/off&lt;/span&gt;
&lt;span class="nv"&gt;icon_position&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; off
&lt;span class="nv"&gt;max_icon_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 80

&lt;span class="c1"&gt;# Paths to default icons.&lt;/span&gt;
&lt;span class="nv"&gt;icon_folders&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /usr/share/icons/Paper/16x16/mimetypes/:/usr/share/icons/Paper/48x48/status/:/usr/share/icons/Paper/16x16/devices/:/usr/share/icons/Paper/48x48/notifications/:/usr/share/icons/Paper/48x48/emblems/


&lt;span class="o"&gt;[&lt;/span&gt;frame&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 3
&lt;span class="nv"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#8EC07C&amp;quot;&lt;/span&gt;

&lt;span class="o"&gt;[&lt;/span&gt;shortcuts&lt;span class="o"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;# Shortcuts are specified as [modifier+][modifier+]...key&lt;/span&gt;
&lt;span class="c1"&gt;# Available modifiers are &amp;quot;ctrl&amp;quot;, &amp;quot;mod1&amp;quot; (the alt-key), &amp;quot;mod2&amp;quot;,&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;quot;mod3&amp;quot; and &amp;quot;mod4&amp;quot; (windows-key).&lt;/span&gt;
&lt;span class="c1"&gt;# Xev might be helpful to find names for keys.&lt;/span&gt;

&lt;span class="c1"&gt;# Close notification.&lt;/span&gt;
&lt;span class="nv"&gt;close&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; ctrl+space

&lt;span class="c1"&gt;# Close all notifications.&lt;/span&gt;
&lt;span class="nv"&gt;close_all&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; ctrl+shift+space

&lt;span class="c1"&gt;# Redisplay last message(s).&lt;/span&gt;
&lt;span class="c1"&gt;# On the US keyboard layout &amp;quot;grave&amp;quot; is normally above TAB and left&lt;/span&gt;
&lt;span class="c1"&gt;# of &amp;quot;1&amp;quot;.&lt;/span&gt;
&lt;span class="nb"&gt;history&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; ctrl+grave

&lt;span class="c1"&gt;# Context menu.&lt;/span&gt;
&lt;span class="nv"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; ctrl+shift+period

&lt;span class="o"&gt;[&lt;/span&gt;urgency_low&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# IMPORTANT: colors have to be defined in quotation marks.&lt;/span&gt;
&lt;span class="c1"&gt;# Otherwise the &amp;quot;#&amp;quot; and following would be interpreted as a comment.&lt;/span&gt;
&lt;span class="nv"&gt;frame_color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#3B7C87&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;foreground&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#3B7C87&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;background&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#191311&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;#background = &amp;quot;#2B313C&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 4

&lt;span class="o"&gt;[&lt;/span&gt;urgency_normal&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;frame_color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#5B8234&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;foreground&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#5B8234&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;background&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#191311&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;#background = &amp;quot;#2B313C&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 6

&lt;span class="o"&gt;[&lt;/span&gt;urgency_critical&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;frame_color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#B7472A&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;foreground&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#B7472A&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;background&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;#191311&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;#background = &amp;quot;#2B313C&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 8


&lt;span class="c1"&gt;# Every section that isn&amp;#39;t one of the above is interpreted as a rules to&lt;/span&gt;
&lt;span class="c1"&gt;# override settings for certain messages.&lt;/span&gt;
&lt;span class="c1"&gt;# Messages can be matched by &amp;quot;appname&amp;quot;, &amp;quot;summary&amp;quot;, &amp;quot;body&amp;quot;, &amp;quot;icon&amp;quot;, &amp;quot;category&amp;quot;,&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;quot;msg_urgency&amp;quot; and you can override the &amp;quot;timeout&amp;quot;, &amp;quot;urgency&amp;quot;, &amp;quot;foreground&amp;quot;,&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;quot;background&amp;quot;, &amp;quot;new_icon&amp;quot; and &amp;quot;format&amp;quot;.&lt;/span&gt;
&lt;span class="c1"&gt;# Shell-like globbing will get expanded.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# SCRIPTING&lt;/span&gt;
&lt;span class="c1"&gt;# You can specify a script that gets run when the rule matches by&lt;/span&gt;
&lt;span class="c1"&gt;# setting the &amp;quot;script&amp;quot; option.&lt;/span&gt;
&lt;span class="c1"&gt;# The script will be called as follows:&lt;/span&gt;
&lt;span class="c1"&gt;#   script appname summary body icon urgency&lt;/span&gt;
&lt;span class="c1"&gt;# where urgency can be &amp;quot;LOW&amp;quot;, &amp;quot;NORMAL&amp;quot; or &amp;quot;CRITICAL&amp;quot;.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# NOTE: if you don&amp;#39;t want a notification to be displayed, set the format&lt;/span&gt;
&lt;span class="c1"&gt;# to &amp;quot;&amp;quot;.&lt;/span&gt;
&lt;span class="c1"&gt;# NOTE: It might be helpful to run dunst -print in a terminal in order&lt;/span&gt;
&lt;span class="c1"&gt;# to find fitting options for rules.&lt;/span&gt;

&lt;span class="c1"&gt;#[espeak]&lt;/span&gt;
&lt;span class="c1"&gt;#    summary = &amp;quot;*&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;#    script = dunst_espeak.sh&lt;/span&gt;

&lt;span class="c1"&gt;#[script-test]&lt;/span&gt;
&lt;span class="c1"&gt;#    summary = &amp;quot;*script*&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;#    script = dunst_test.sh&lt;/span&gt;

&lt;span class="c1"&gt;#[ignore]&lt;/span&gt;
&lt;span class="c1"&gt;#    # This notification will not be displayed&lt;/span&gt;
&lt;span class="c1"&gt;#    summary = &amp;quot;foobar&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;#    format = &amp;quot;&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;#[signed_on]&lt;/span&gt;
&lt;span class="c1"&gt;#    appname = Pidgin&lt;/span&gt;
&lt;span class="c1"&gt;#    summary = &amp;quot;*signed on*&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;#    urgency = low&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#[signed_off]&lt;/span&gt;
&lt;span class="c1"&gt;#    appname = Pidgin&lt;/span&gt;
&lt;span class="c1"&gt;#    summary = *signed off*&lt;/span&gt;
&lt;span class="c1"&gt;#    urgency = low&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#[says]&lt;/span&gt;
&lt;span class="c1"&gt;#    appname = Pidgin&lt;/span&gt;
&lt;span class="c1"&gt;#    summary = *says*&lt;/span&gt;
&lt;span class="c1"&gt;#    urgency = critical&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#[twitter]&lt;/span&gt;
&lt;span class="c1"&gt;#    appname = Pidgin&lt;/span&gt;
&lt;span class="c1"&gt;#    summary = *twitter.com*&lt;/span&gt;
&lt;span class="c1"&gt;#    urgency = normal&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# vim: ft=cfg&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="bsd"></category><category term="openbsd"></category><category term="netctl"></category><category term="wifi"></category><category term="nmctl"></category><category term="network-manager"></category><category term="hotplugd"></category><category term="automount"></category><category term="dunst"></category></entry><entry><title>Building FreeBSD Custom Kernel</title><link href="http://bijanebrahimi.github.io/blog/building-freebsd-custom-kernel.html" rel="alternate"></link><published>2017-10-27T11:21:00+03:30</published><updated>2017-10-27T11:21:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-10-27:/blog/building-freebsd-custom-kernel.html</id><summary type="html">&lt;p&gt;According to &lt;a href="https://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook"&gt;FreeBSD Handbook&lt;/a&gt;, there are two ways of building a custom
kernel: &lt;a href="https://www.freebsd.org/doc/en_US.ISO8859-1/books/developers-handbook/kernelbuild.html"&gt;The Traditional Way&lt;/a&gt; and &lt;a href="https://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/kernelconfig-building.html"&gt;The New Way&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Either way, we should create a custom kernel configuration file, Then we use
this custom kernel configuration for building the new kernel:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /usr/src
$ cp sys/amd64/config/GENERIC …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;According to &lt;a href="https://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook"&gt;FreeBSD Handbook&lt;/a&gt;, there are two ways of building a custom
kernel: &lt;a href="https://www.freebsd.org/doc/en_US.ISO8859-1/books/developers-handbook/kernelbuild.html"&gt;The Traditional Way&lt;/a&gt; and &lt;a href="https://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/kernelconfig-building.html"&gt;The New Way&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Either way, we should create a custom kernel configuration file, Then we use
this custom kernel configuration for building the new kernel:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /usr/src
$ cp sys/amd64/config/GENERIC sys/amd64/config/CUSTOM
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;For example, we can enable kernel debuggings enabled in our custom
configuration:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ cat &amp;gt;&amp;gt; sys/amd64/config/CUSTOM &amp;lt;EOF
makeoptions -g
options KDB
options DDB
EOF
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now, to compile the new kernel with our custom configuration:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;make -j &lt;span class="m"&gt;16&lt;/span&gt; buildkernel &lt;span class="nv"&gt;KERNCONF&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;CUSTOM
make -j &lt;span class="m"&gt;16&lt;/span&gt; installkernel &lt;span class="nv"&gt;KERNCONF&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;CUSTOM
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you're experiencing modifying kernel and trying to avoid re-
compiling the kernel every time you have a small change in the
source code, use the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;make -j &lt;span class="m"&gt;16&lt;/span&gt; buildkernel &lt;span class="nv"&gt;KERNCONF&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;CUSTOM -DKERNFAST
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;Tips&lt;/strong&gt;: Remember to remove the multiple make jobs &lt;code&gt;-j&lt;/code&gt; flags
if you have errors in compiling the source to easily spot the
error message:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;make buildkernel &lt;span class="nv"&gt;KERNCONF&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;CUSTOM -DKERNFAST
&lt;/pre&gt;&lt;/div&gt;</content><category term="freebsd"></category><category term="kernel"></category><category term="compile"></category></entry><entry><title>Privileged Seperated Processes</title><link href="http://bijanebrahimi.github.io/blog/privileged-seperated-processes.html" rel="alternate"></link><published>2017-10-24T20:17:00+03:30</published><updated>2017-10-24T20:17:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-10-24:/blog/privileged-seperated-processes.html</id><summary type="html">&lt;h2&gt;An Intorduction&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;In computer programming and computer security, privilege separation is a
technique in which a program is divided into parts which are limited to the
specific privileges they require in order to perform a specific task. This is
used to mitigate the potential damage of a computer security vulnerability …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;h2&gt;An Intorduction&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;In computer programming and computer security, privilege separation is a
technique in which a program is divided into parts which are limited to the
specific privileges they require in order to perform a specific task. This is
used to mitigate the potential damage of a computer security vulnerability.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Privilege_separation"&gt;Privilege Separation&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There are &lt;a href="http://www.openbsd.org/papers/ven05-deraadt/"&gt;many great resources&lt;/a&gt; describing the architecture of a priviledge
separated process and the need for such architecrues, which I'm sure you already
read or will ;-)&lt;/p&gt;
&lt;p&gt;What I'm really interested in, is the way the priviledged separated processes
are able to talk to each other. Hope you haveare already familliar with Unix
IPCs, but if you don't, here's &lt;a href="http://beej.us/guide/bgipc/"&gt;Beej's Guide to Unix IPC&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This is (hopefully) the first of a few posts about writing privsep processes.
Hope it helps.&lt;/p&gt;
&lt;h2&gt;socketpair(2)&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;The socketpair() call creates an unnamed pair of connected sockets in the
specified domain d, of the specified type, and using the optionally
specified protocol.  The descriptors used in referencing the new sockets
are returned in sv[0] and sv&lt;a href="https://en.wikipedia.org/wiki/Privilege_separation"&gt;1&lt;/a&gt;.  The two sockets are indistinguishable.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Unlike &lt;a href="http://man.openbsd.org/pipe.2"&gt;pipe(2)&lt;/a&gt; which are uni-directional way of sending messages,
&lt;a href="http://man.openbsd.org/socket.2"&gt;socket(2)&lt;/a&gt; are bi-directional, which means they are perfect for processes to talk
back to each others. &lt;a href="http://man.openbsd.org/socketpair.2"&gt;socketpair(2)&lt;/a&gt; will create two of them for us. each
connected to the other using the specified Protocol.&lt;/p&gt;
&lt;p&gt;&lt;span class="graphviz" style="text-align: center;"&gt;&lt;img src="data:image/png;base64,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"&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The above, Illustrates a socketpair of type &lt;code&gt;UNIX Sockets&lt;/code&gt; shared by the aprent
and the child. Since the sockets are indistinguishable, there's no difference
which uses which.&lt;/p&gt;
&lt;p&gt;The following snippet, Creates a socket pair and pass it to the child:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;err.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;sys/wait.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;sys/types.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;

&lt;span class="cp"&gt;#define MAX_BUF_SIZE      128&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;child_process&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;parent_process&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;pid_t&lt;/span&gt; &lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;


&lt;span class="kt"&gt;int&lt;/span&gt;
&lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;pid_t&lt;/span&gt; &lt;span class="n"&gt;child_pid&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socketpair&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AF_UNIX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PF_UNSPEC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;errx&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Failed to open socketpair&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;child_pid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fork&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;errx&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Failed to fork the process&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;child_pid&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;parent_process&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;child_pid&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;child_process&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="cm"&gt;/* Not reachable */&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt;
&lt;span class="nf"&gt;child_process&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;MAX_BUF_SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="n"&gt;snprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;MAX_BUF_SIZE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Hello World&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;MAX_BUF_SIZE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;errx&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Failed to write Message&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt;
&lt;span class="nf"&gt;parent_process&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;pid_t&lt;/span&gt; &lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;ssize_t&lt;/span&gt; &lt;span class="n"&gt;nbytes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;MAX_BUF_SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nbytes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;MAX_BUF_SIZE&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;warn&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Failed to read&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nbytes&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;nbytes&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Received &lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;%s&lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s"&gt; from the Child&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;waitpid&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;WAIT_ANY&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;WEXITSTATUS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And the output is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ gcc -o privsep main.c
$ ./privsep
Received &lt;span class="s2"&gt;&amp;quot;Hello World&amp;quot;&lt;/span&gt; from the Child
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Tips:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Since the child process shares rge same memory address with it's parent, it
has access to all the descriptors the parent has opened, so it is a good
practice to close all unnecessary descriptors (like standard I/O) before
actually running the child's logic after calling the &lt;code&gt;fork(2)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the next post, I will introduce the &lt;code&gt;imsg_init(3)&lt;/code&gt;. The OpenBSD way of
writing privsep processes.&lt;/p&gt;</content><category term="openbsd"></category><category term="imsg_init"></category><category term="socket_pair"></category><category term="privsep"></category></entry><entry><title>Pelican on OpenBSD</title><link href="http://bijanebrahimi.github.io/blog/pelican-on-openbsd.html" rel="alternate"></link><published>2017-10-13T22:49:00+03:30</published><updated>2017-10-13T22:49:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-10-13:/blog/pelican-on-openbsd.html</id><summary type="html">&lt;p&gt;If you haven't introduced to Pelican yet, you should probably read from this
blog:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Pelican is a static site generator, written in Python, that requires no
database or server-side logic.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.getpelican.com/"&gt;blog.getpelican.com&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;By creating a pelican project, a Mekfile will be created (by your confirmation)
to ease the process …&lt;/p&gt;</summary><content type="html">&lt;p&gt;If you haven't introduced to Pelican yet, you should probably read from this
blog:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Pelican is a static site generator, written in Python, that requires no
database or server-side logic.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.getpelican.com/"&gt;blog.getpelican.com&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;By creating a pelican project, a Mekfile will be created (by your confirmation)
to ease the process of writing and publishing your posts, However the format of
this Makefile is in GNU Make format and you'll get the following errors if you
run it on your BSD (FreeBSD and OpenBSD as I am aware of):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ make devserver
No closing parenthesis in archive specification
*** Parse error in /path/to/pelican/project: Error in archive specification: &lt;span class="s2"&gt;&amp;quot;(0, 1)&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:31&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;endif&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:33&lt;span class="o"&gt;)&lt;/span&gt;
No closing parenthesis in archive specification
*** Parse error: Error in archive specification: &lt;span class="s2"&gt;&amp;quot;(0, 1)&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:36&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;endif&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:38&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;PORT&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:74&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;else&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:76&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;endif&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:78&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;SERVER&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:81&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;else&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:83&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;endif&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:85&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;PORT&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:89&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;else&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:91&lt;span class="o"&gt;)&lt;/span&gt;
*** Parse error: Need an operator in &lt;span class="s1"&gt;&amp;#39;endif&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Makefile:93&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There's plentty of good resources online, referencing the differences. For
portable makefiles, you should probably read &lt;a href="https://www.gnu.org/software/make/manual/html_node/Features.html"&gt;Features of GNU make&lt;/a&gt; and 
&lt;a href="https://www.gnu.org/software/make/manual/html_node/Missing.html"&gt;Features of GNU make&lt;/a&gt; and of course, The OpenBSD's &lt;a href="https://man.openbsd.org/make.1"&gt;make(1)&lt;/a&gt; and The
FreeBSD's &lt;a href="https://www.freebsd.org/cgi/man.cgi?query=make(1)"&gt;make(1)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The following patch illustrates the changes and I hope it helps others:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gh"&gt;diff --git a/Makefile b/Makefile&lt;/span&gt;
&lt;span class="gh"&gt;index d1ddf80..d87b1e9 100644&lt;/span&gt;
&lt;span class="gd"&gt;--- a/Makefile&lt;/span&gt;
&lt;span class="gi"&gt;+++ b/Makefile&lt;/span&gt;
&lt;span class="gu"&gt;@@ -2,7 +2,7 @@ PY?=python3&lt;/span&gt;
 PELICAN?=pelican
 PELICANOPTS=

&lt;span class="gd"&gt;-BASEDIR=$(CURDIR)&lt;/span&gt;
&lt;span class="gi"&gt;+BASEDIR=$(.CURDIR)&lt;/span&gt;
 INPUTDIR=$(BASEDIR)/content
 OUTPUTDIR=$(BASEDIR)/output
 CONFFILE=$(BASEDIR)/pelicanconf.py
&lt;span class="gu"&gt;@@ -28,14 +28,14 @@ DROPBOX_DIR=~/Dropbox/Public/&lt;/span&gt;
 GITHUB_PAGES_BRANCH=gh-pages

 DEBUG ?= 0
&lt;span class="gd"&gt;-ifeq ($(DEBUG), 1)&lt;/span&gt;
&lt;span class="gi"&gt;+.if $(DEBUG) == 1&lt;/span&gt;
        PELICANOPTS += -D
&lt;span class="gd"&gt;-endif&lt;/span&gt;
&lt;span class="gi"&gt;+.endif&lt;/span&gt;

 RELATIVE ?= 0
&lt;span class="gd"&gt;-ifeq ($(RELATIVE), 1)&lt;/span&gt;
&lt;span class="gi"&gt;+.if $(RELATIVE) == 1&lt;/span&gt;
        PELICANOPTS += --relative-urls
&lt;span class="gd"&gt;-endif&lt;/span&gt;
&lt;span class="gi"&gt;+.endif&lt;/span&gt;

 help:
        @echo &amp;#39;Makefile for a pelican Web site                                           &amp;#39;
&lt;span class="gu"&gt;@@ -71,26 +71,26 @@ regenerate:&lt;/span&gt;
        $(PELICAN) -r $(INPUTDIR) -o $(OUTPUTDIR) -s $(CONFFILE) $(PELICANOPTS)

 serve:
&lt;span class="gd"&gt;-ifdef PORT&lt;/span&gt;
&lt;span class="gi"&gt;+.ifdef PORT&lt;/span&gt;
        cd $(OUTPUTDIR) &amp;amp;&amp;amp; $(PY) -m pelican.server $(PORT)
&lt;span class="gd"&gt;-else&lt;/span&gt;
&lt;span class="gi"&gt;+.else&lt;/span&gt;
        cd $(OUTPUTDIR) &amp;amp;&amp;amp; $(PY) -m pelican.server
&lt;span class="gd"&gt;-endif&lt;/span&gt;
&lt;span class="gi"&gt;+.endif&lt;/span&gt;

 serve-global:
&lt;span class="gd"&gt;-ifdef SERVER&lt;/span&gt;
&lt;span class="gi"&gt;+.ifdef SERVER&lt;/span&gt;
        cd $(OUTPUTDIR) &amp;amp;&amp;amp; $(PY) -m pelican.server 80 $(SERVER)
&lt;span class="gd"&gt;-else&lt;/span&gt;
&lt;span class="gi"&gt;+.else&lt;/span&gt;
        cd $(OUTPUTDIR) &amp;amp;&amp;amp; $(PY) -m pelican.server 80 0.0.0.0
&lt;span class="gd"&gt;-endif&lt;/span&gt;
&lt;span class="gi"&gt;+.endif&lt;/span&gt;


 devserver:
&lt;span class="gd"&gt;-ifdef PORT&lt;/span&gt;
&lt;span class="gi"&gt;+.ifdef PORT&lt;/span&gt;
        $(BASEDIR)/develop_server.sh restart $(PORT)
&lt;span class="gd"&gt;-else&lt;/span&gt;
&lt;span class="gi"&gt;+.else&lt;/span&gt;
        $(BASEDIR)/develop_server.sh restart
&lt;span class="gd"&gt;-endif&lt;/span&gt;
&lt;span class="gi"&gt;+.endif&lt;/span&gt;

 stopserver:
        $(BASEDIR)/develop_server.sh stop
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;More to Read:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.quora.com/What-is-the-difference-between-GNU-Makefile-and-BSD-Makefile"&gt;What is the difference between GNU Makefile and BSD Makefile?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="bsd"></category><category term="openbsd"></category><category term="pelican"></category><category term="Makefile"></category><category term="python"></category></entry><entry><title>OpenBSD 6.2 Upgrade</title><link href="http://bijanebrahimi.github.io/blog/openbsd-62-upgrade.html" rel="alternate"></link><published>2017-10-10T22:49:00+03:30</published><updated>2017-10-10T22:49:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-10-10:/blog/openbsd-62-upgrade.html</id><summary type="html">&lt;p&gt;The Upgrading Process is stupidly easy. The process is &lt;a href="https://www.openbsd.org/faq/upgrade62.html"&gt;well documented&lt;/a&gt; for each release
and is available after the release of binary packages and when install images are out but
before going any further, please read the OpenBSD 6.2 &lt;a href="4"&gt;new features&lt;/a&gt; for the list of
changes and improvements. &lt;/p&gt;
&lt;p&gt;The …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The Upgrading Process is stupidly easy. The process is &lt;a href="https://www.openbsd.org/faq/upgrade62.html"&gt;well documented&lt;/a&gt; for each release
and is available after the release of binary packages and when install images are out but
before going any further, please read the OpenBSD 6.2 &lt;a href="4"&gt;new features&lt;/a&gt; for the list of
changes and improvements. &lt;/p&gt;
&lt;p&gt;The process is split into two separate processes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;First, You should upgrade the base system using one of two possibles. Using a bootable disk
image or using the manual process which is not recommended.&lt;/li&gt;
&lt;li&gt;Second, Upgrading the binary packages.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I choose Upgrading via a bootable media since it is the highly recommended way:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;$curl&lt;/span&gt; -o install62.fs https://openbsd.mirror.netelligent.ca/pub/OpenBSD/6.2/amd64/install62.fs
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Writing the image to the USB stick was a matter of executing &lt;code&gt;dd&lt;/code&gt; command (as always):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sysctl hw.disknames
hw.disknames&lt;span class="o"&gt;=&lt;/span&gt;sd0:da0bedc25009303c,cd0:,sd1:9e5b01f8dc3ea3f3
$ doas dd &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;install62.fs &lt;span class="nv"&gt;of&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/dev/rsd1c &lt;span class="nv"&gt;bs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1m
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Again, if you're unfamiliar with anything like OpenBSD way of &lt;a href="https://www.openbsd.org/faq/faq14.html"&gt;dealing with storage devices&lt;/a&gt; and
other things, please consider reading the entire &lt;a href="https://www.openbsd.org/faq/"&gt;FAQ&lt;/a&gt;. It really pays off, I promise ;-)&lt;/p&gt;
&lt;p&gt;Now the next move is follow the pre-upgrade which I actually forgot. For my currect
setup, it was only to manually remove the man pages to avoid having old manpages in
the new system after successfull upgrade:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ doas rm -rf /usr/share/man/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now, Just rebooted the machine and booted from the USB stick and Press (U)pgrade and that was it.
After confirming the keyboard layout and my laptop's primary disk where my OpenBSD installation
resides, the process of Upgrading &lt;strong&gt;The Base System&lt;/strong&gt; was done. After completion and rebooting
the machine, the first thing the new OS did was retrieving the newer firmwares which I skipped
since at the time, I had no (reliable) Internet connection, but don't worry, you can do it later:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ uname -a
OpenBSD localhost.lenovo 6.2 GENERIC.MP#134 amd64
$ doas fw_update
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now, it's time to &lt;strong&gt;update the binary packages&lt;/strong&gt; since their dependencies on the base system has
just been upgraded. But that was just one command away:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ doas pkg_add -u
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That was it. Hope to write more about OpenBSD in the near future.&lt;/p&gt;</content><category term="openbsd"></category><category term="upgrade"></category></entry><entry><title>Freebsd's .mount.conf</title><link href="http://bijanebrahimi.github.io/blog/freebsds-mountconf.html" rel="alternate"></link><published>2017-02-24T22:05:00+03:30</published><updated>2017-02-24T22:05:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-02-24:/blog/freebsds-mountconf.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;As I'm getting more and more familiar with the FreeBSD Operating System and
it's wonderfull architeture and design, I found the need to work with different
versions of FreeBSD live (specially at work) and since it's not a good idea to install
every single version I needed into a …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;As I'm getting more and more familiar with the FreeBSD Operating System and
it's wonderfull architeture and design, I found the need to work with different
versions of FreeBSD live (specially at work) and since it's not a good idea to install
every single version I needed into a USB flash drive, I tried Grub to boot a given
Freebsd ISO image (admittedly I'm still unfamiliar with the powers of FreeBSD's
own boot loader program).&lt;/p&gt;
&lt;h1&gt;How Grub is booting an ISO image&lt;/h1&gt;
&lt;p&gt;Essentially what the grub does, is loading the given ISO image using &lt;code&gt;loopback&lt;/code&gt;
command as a loop device and mount it in a special &lt;code&gt;(loop)&lt;/code&gt; directory. That's
pretty much all that grub does before loading the kernel into memory thus
executing it. After passing the execution process to the kernel, the special loop device
is lost and kernel at some point needs to remount it again in order to
complete it's booting process. This process of mounting the root filesystem 
may differ between operating systems. For example, Ubuntu uses a parameter passed
to kernel named &lt;code&gt;iso-scan/filename&lt;/code&gt; which essentially tells the kernel to look for
which file to mount as root filesystem. Kernel does this by mounting every existing
partitions looking for this speific path and when it finds it, it mounts it as
root filesystem and the process of booting the kernel continues.&lt;/p&gt;
&lt;h1&gt;How to boot FreeBSD from an ISO image&lt;/h1&gt;
&lt;p&gt;As I searched the web, I found a few other people having the same problem booting
FreeBSD from ISO images and found a few interesting solutions like
&lt;a href="http://mfsbsd.vx.sk/"&gt;mfsBSD&lt;/a&gt; which is a set of scripts building a special
FreeBSD kernel loaded entirely into RAM thus no need to mounting the root
filesystem at the first place. But that wasn't my solution till I find FreeBSD's
mount configuration file manual.&lt;/p&gt;
&lt;h1&gt;FreeBSD's &lt;code&gt;.mount.conf&lt;/code&gt; To Rescue&lt;/h1&gt;
&lt;p&gt;FreeBSD provides a kind of scriptable process of finding and mounting
the root filesystem via a file named &lt;code&gt;.mount.conf&lt;/code&gt;. The process of mounting the
root filesystem is fully described in the &lt;a href="https://www.freebsd.org/cgi/man.cgi?query=mount.conf"&gt;man page&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;What is interesting is that the kernel can follow the intructions in the &lt;code&gt;.mount.conf&lt;/code&gt;
file in the root filesystem it mounts (if exists) and change it's current root
filesystem accordingly:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;{FS}:{MOUNTPOINT} {OPTIONS}&lt;/code&gt;
The kernel will try to mount this in an operation equivalent to:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mount -t {FS} -o {OPTIONS} {MOUNTPOINT} /&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;If this is successfully mounted, further lines in .mount.conf
are ignored.  If all lines in .mount.conf have been processed
and no root file system has been successfully mounted, then
the action specified by &lt;code&gt;.onfail&lt;/code&gt; is performed.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.ask&lt;/code&gt; When the kernel processes this line, a &lt;code&gt;mountroot&amp;gt;&lt;/code&gt; command-
line prompt is displayed. At this prompt, the operator can
enter the the root mount.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.md file&lt;/code&gt; Create a memory backed &lt;a href="https://www.freebsd.org/cgi/man.cgi?query=md"&gt;md(4)&lt;/a&gt; virtual disk, using file as the
backing store.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So what the really need to do is to put a mount config file in our USB flash drive's
root directory which should contain a &lt;code&gt;md&lt;/code&gt; command creating a memory backed
virtual disk from our FreeBSD's iso image and then mount it as our new root
filesystem:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;.timeout&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="na"&gt;.md&lt;/span&gt; &lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;iso&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;FreeBSD-11.0-RELEASE-amd64-dvd1.iso&lt;/span&gt;
&lt;span class="na"&gt;.timeout&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="nl"&gt;cd9660:&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="nf"&gt;dev&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;md&lt;/span&gt;&lt;span class="c"&gt;# ro&lt;/span&gt;
&lt;span class="na"&gt;.ask&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;Important&lt;/strong&gt;: please note that when the kernel mounts the new rootfilesystem, 
there should be a directory named &lt;code&gt;dev&lt;/code&gt; inside the new root filesystem for kernerl
to remount the &lt;code&gt;devfs&lt;/code&gt; on it. The whole process fails (sadly with no proper 
message) if the &lt;code&gt;dev&lt;/code&gt; doesn't exist.&lt;/p&gt;
&lt;h1&gt;The Solution&lt;/h1&gt;
&lt;p&gt;The following is the whole process plus formatting and installing grub from a
debian-based linux distro:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="x"&gt; Installing GRUB, Assuming /dev/sdb is the USB flash drive device&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt; mount /dev/sdb1 /mnt&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt; mkdir /mnt/boot&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt; grub-install --boot-directory=/mnt/boot /dev/sdb&lt;/span&gt;

&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="x"&gt; Copy FreeBSD iso image and creating proper grub configuration file&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt; mkdir /mnt/iso&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt; cp ~/Downloads/FreeBSD-11.0-RELEASE-amd64-dvd1.iso /mnt/iso&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt; cat &amp;gt; /mnt/boot/grub/grub.cfg &amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="x"&gt;insmod loopback&lt;/span&gt;
&lt;span class="x"&gt;insmod iso9660&lt;/span&gt;
&lt;span class="x"&gt;insmod ufs2&lt;/span&gt;
&lt;span class="x"&gt;insmod ntfs&lt;/span&gt;
&lt;span class="x"&gt;menuentry &amp;quot;FreeBSD 11.0 amd64&amp;quot; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;  set isofile=&amp;quot;/iso/FreeBSD-11.0-RELEASE-amd64-dvd1.iso&amp;quot;&lt;/span&gt;
&lt;span class="x"&gt;  loopback loop (hd0,1)&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;isofile&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;  kfreebsd  (loop)/boot/kernel/kernel&lt;/span&gt;
&lt;span class="x"&gt;}&lt;/span&gt;
&lt;span class="x"&gt;EOF&lt;/span&gt;

&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="x"&gt; Create FreeBSD mount configuration file&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt; mkdir /mnt/dev&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt; cat &amp;gt; /mnt/.mount.conf &amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="x"&gt;.timeout 3&lt;/span&gt;
&lt;span class="x"&gt;.md /iso/FreeBSD-11.0-RELEASE-amd64-dvd1.iso&lt;/span&gt;
&lt;span class="x"&gt;.timeout 4&lt;/span&gt;
&lt;span class="x"&gt;cd9660:/dev/md&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="x"&gt; ro&lt;/span&gt;
&lt;span class="x"&gt;.ask&lt;/span&gt;
&lt;span class="x"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That's It. Now after reboot and booting the USB flash drive, GRUB loads the
freebsd kernel from it's &lt;code&gt;loopback&lt;/code&gt; device, and when FreeBSD kernel loads, it
fails mounting the root filesystem and drops into a prompt command line asking
for the root filesystem. We can Enter &lt;code&gt;?&lt;/code&gt; to first get a list of known devies
and Then mount our USB flash drive partition as a temporary root filesystem
allowing kernel to find our &lt;code&gt;.mount.conf&lt;/code&gt; file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mountroot&amp;gt; msdosfs:/dev/da0s1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This last step can be avoided by setting the &lt;code&gt;FreeBSD.vfs.root.mountfrom&lt;/code&gt; option
from grub which I have not tested yet:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;set FreeBSD.vfs.root.mountfrom=msdosfs:/dev/da0s1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If nothing goes wrong (specially if you didn't forget to create a &lt;code&gt;dev&lt;/code&gt;
directory in USB flash drive's root directory) you should login into your FreeBSD
iso image:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ df
Filesystem 1K-blocks    Used  Avail Capcity  Mounted on
/dev/md0      &lt;span class="m"&gt;286146&lt;/span&gt; &lt;span class="m"&gt;2861416&lt;/span&gt;      &lt;span class="m"&gt;8&lt;/span&gt;    100%  /
/dev/da0s1   &lt;span class="m"&gt;7561408&lt;/span&gt; &lt;span class="m"&gt;6621600&lt;/span&gt;  &lt;span class="m"&gt;99808&lt;/span&gt;     88%  /mnt
devfs              &lt;span class="m"&gt;1&lt;/span&gt;       &lt;span class="m"&gt;1&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt;    100%  /dev
/dev/md1       &lt;span class="m"&gt;31260&lt;/span&gt;     &lt;span class="m"&gt;308&lt;/span&gt;  &lt;span class="m"&gt;28452&lt;/span&gt;      1%  /var
/dev/md2       &lt;span class="m"&gt;19356&lt;/span&gt;      &lt;span class="m"&gt;28&lt;/span&gt;  &lt;span class="m"&gt;17780&lt;/span&gt;      0%  /tmp
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Look that the old root filesystem (&lt;code&gt;/dev/da0s1&lt;/code&gt;) is re-mounted on &lt;code&gt;/mnt&lt;/code&gt; as
described in manual. Hope it helps other :-)&lt;/p&gt;</content><category term="freebsd"></category><category term="grub"></category><category term="iso"></category><category term="mount.conf"></category></entry><entry><title>Graphviz in markdown</title><link href="http://bijanebrahimi.github.io/blog/graphviz-in-markdown.html" rel="alternate"></link><published>2017-02-20T20:12:00+03:30</published><updated>2017-02-20T20:12:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-02-20:/blog/graphviz-in-markdown.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;There is a good tutorial on &lt;a href="https://github.com/TLmaK0/gravizo"&gt;How to include graphviz graphs in github&lt;/a&gt;. Basically it introduced me to an online web service which takes graphviz scripts as part of a url query string and renders it into an image type. It is a very good idea for many reasons …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;There is a good tutorial on &lt;a href="https://github.com/TLmaK0/gravizo"&gt;How to include graphviz graphs in github&lt;/a&gt;. Basically it introduced me to an online web service which takes graphviz scripts as part of a url query string and renders it into an image type. It is a very good idea for many reasons. One, the graph is still plain text and searchable inside source files, Second, editing an already drawn graph inside a wiki page is now very easy and the dot files are pretty easy to write.&lt;/p&gt;
&lt;h1&gt;Problem?&lt;/h1&gt;
&lt;p&gt;So, what's the problem? As I said, It was a good idea (even our Project Manager liked it since we're about to move our project's knowledge base into a local Gitlab's server, way better than using &lt;a href="http://asciiflow.com"&gt;asciiflow.com&lt;/a&gt;). The Only problem was that It was an unnecessary dependency to use an remote web-service and I thought why not I build our own local version of it? So, I did.&lt;/p&gt;
&lt;h1&gt;Requirments&lt;/h1&gt;
&lt;p&gt;Since we already had an omnibus version of gitlab running on a debian server, I tried to write a simple php-script serving on the already running bundle version of nginx in gitlab omnibus package. The following is the work around. If you have a similiar but not quiet the same situation, you may consider changing the following steps as fits your needs so I try to explain as much as needed.&lt;/p&gt;
&lt;h1&gt;Gitlab's Nginx, a proxy to local Apache&lt;/h1&gt;
&lt;p&gt;Since I knew php way better than ruby (still I'm not a php developer anymore), I deided to write my graphviz web-service in php language, so I installed apache (running on port 8090) and php and no to forget, the graphviz command tools:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ apt-get install apache2 libapache2-mod-php5 graphviz
$ editor /etc/apache2/ports.conf
Listen 8090
$ editor /etc/apache2/sites-enabled/000-default.conf
&lt;span class="nt"&gt;&amp;lt;VirtualHost&lt;/span&gt; &lt;span class="err"&gt;*:8090&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  ServerAdmin webmaster@localhost
  DocumentRoot /var/www/webtools.company_domain.net
  ErrorLog &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;APACHE_LOG_DIR&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;/error.log
  CustomLog &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;APACHE_LOG_DIR&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;/access.log combined
&lt;span class="nt"&gt;&amp;lt;/VirtualHost&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and set the gitlab's nginx to work as a proxy to my apache web-server:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ editor /var/opt/gitlab/nginx/conf/webtools.company_domain.net
server &lt;span class="o"&gt;{&lt;/span&gt;
  listen *:80&lt;span class="p"&gt;;&lt;/span&gt;
  server_name webtools.company_domain.net&lt;span class="p"&gt;;&lt;/span&gt;
  access_log /var/log/webtools.company_domain.net.access.log&lt;span class="p"&gt;;&lt;/span&gt;
  error_log /var/log/webtools.company_domain.net.error.log&lt;span class="p"&gt;;&lt;/span&gt;
  location / &lt;span class="o"&gt;{&lt;/span&gt;
    proxy_pass http://127.0.0.1:8090&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
$ nano /etc/gitlab/gitlab.rb
nginx&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;custom_nginx_config&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;include /var/opt/gitlab/nginx/conf/webtools.company_domain.net;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we shoould reconfigure gitlab to create the new nginx configuration file from our changes in &lt;code&gt;/etc/gitlab/gitlab.rb&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ gitlab-ctl reconfigure
$ gitlab-ctl restart nginx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now the only missing pieces is the actual php script. Since it's a prototype version of our graphviz web service, we only render svg formats:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt; &lt;span class="nx"&gt;nano&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="err"&gt;/www/webtools.company_domain.net/graphviz/index.php&lt;/span&gt;
&lt;span class="cp"&gt;&amp;lt;?php&lt;/span&gt;
  &lt;span class="nv"&gt;$dot_content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;rawurldecode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_SERVER&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;QUERY_STRING&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
  &lt;span class="nv"&gt;$dot_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;tempnam&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/tmp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;dot_&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="nb"&gt;file_put_contents&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$dot_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$dot_content&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="nb"&gt;header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-type: image/svg+xml&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="nb"&gt;system&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;dot -Tsvg &amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="nv"&gt;$dot_file&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="nb"&gt;unlink&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$dot_file&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="cp"&gt;?&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now, the following markdown script should nicely render as a svg image in our rendered markdown wiki pages:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Alt&lt;/span&gt; &lt;span class="n"&gt;Text&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="nl"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//webtools.company_domain.net/graphviz/?&lt;/span&gt;
&lt;span class="n"&gt;digraph&lt;/span&gt; &lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;aize&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;4,4&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;parse&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;parse&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;init&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dotted&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cleanup&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;execute&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;make_string&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
    &lt;span class="n"&gt;init&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;make_string&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;edge&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;red&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;printf&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bold&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100 times&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;make_string&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;make a string&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;filled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;.7 .3 1.0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;execute&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;compare&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Hope it helps other people as well :-)&lt;/p&gt;</content><category term="gitlab"></category><category term="wiki"></category><category term="graphviz"></category><category term="debian"></category><category term="omnibus"></category><category term="apache"></category><category term="nginx"></category><category term="php"></category><category term="dot"></category><category term="svg"></category></entry><entry><title>Books I Read in 2016</title><link href="http://bijanebrahimi.github.io/blog/books-i-read-in-2016.html" rel="alternate"></link><published>2017-02-17T14:40:00+03:30</published><updated>2017-02-17T14:40:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-02-17:/blog/books-i-read-in-2016.html</id><summary type="html">&lt;p&gt;The List isn't long. same as the last year, I was spending my last months in the military service. I think there are a couple of books missing from the list which I might forgot them for the moment of creating this post. Also I hope I to find the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The List isn't long. same as the last year, I was spending my last months in the military service. I think there are a couple of books missing from the list which I might forgot them for the moment of creating this post. Also I hope I to find the time in the next year to also keep track of the useful articles since I'm mainly reading them instead of hard cover books.&lt;/p&gt;
&lt;h2&gt;Computer &amp;amp; Programming&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Head First C&lt;/li&gt;
&lt;li&gt;Scalable C by Pieter Hintjens&lt;/li&gt;
&lt;li&gt;The Design and Implementation of the FreeBSD by Marshall Kirk McKusick (only a few chapters)&lt;/li&gt;
&lt;/ul&gt;</content></entry><entry><title>GCC Cross-Compiler</title><link href="http://bijanebrahimi.github.io/blog/gcc-cross-compiler.html" rel="alternate"></link><published>2017-02-17T12:04:00+03:30</published><updated>2017-02-17T12:04:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-02-17:/blog/gcc-cross-compiler.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;A cross compiler is a compiler capable of creating executable code for a platform other than the one on which the compiler is running. For example, a compiler that runs on a Windows 7 PC but generates code that runs on Android smartphone is a cross compiler.&lt;/p&gt;
&lt;p&gt;--&lt;a href="https://en.wikipedia.org/wiki/Crosscompiler"&gt;Wikipedia&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Before …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;A cross compiler is a compiler capable of creating executable code for a platform other than the one on which the compiler is running. For example, a compiler that runs on a Windows 7 PC but generates code that runs on Android smartphone is a cross compiler.&lt;/p&gt;
&lt;p&gt;--&lt;a href="https://en.wikipedia.org/wiki/Crosscompiler"&gt;Wikipedia&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Before we continue, there issome definitions we need to decide.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Build&lt;/strong&gt;: The machine you are building on which in our case, we're building our cross-compiler on a linux machine (&lt;code&gt;--host&lt;/code&gt; option).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Host&lt;/strong&gt;: The machine that you are building for and again, it's a linux machine we're trying to build our binaries (&lt;code&gt;--host&lt;/code&gt; option).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Target&lt;/strong&gt;: The machine that GCC will produce code for which is a freebsd machine (&lt;code&gt;--target&lt;/code&gt; option).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: To decide the values of the above configuration, simply run &lt;code&gt;gdb --version&lt;/code&gt; on the native machine. for a linux machine it's &lt;code&gt;x86_64-pc-linux-gnu&lt;/code&gt; and for my target machine it's &lt;code&gt;amd64-marcel-freebsd9.2&lt;/code&gt;. Since we're building and running our cross-compile on the same machine (&lt;code&gt;x86_64-pc-linux-gnu&lt;/code&gt;), we don't need to specify the build and the host configuration which gcc will pick automatically.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TARGET&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;amd64-marcel-freebsd9.2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And since, we don't wan to mix our cross-compile toolchains with our native binaries, we install our cross-compiler toolchains in the &lt;code&gt;/usr/cross-build&lt;/code&gt; directory:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;PREFIX&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/cross-build
$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TARGET_PREFIX&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt;/&lt;span class="nv"&gt;$TARGET&lt;/span&gt;
$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PATH&lt;/span&gt;:&lt;span class="nv"&gt;$PREFIX&lt;/span&gt;/bin
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;One more important note before start compiling is that we need the head-files and libraries of the target machine. So we should copy &lt;code&gt;/lib&lt;/code&gt; and &lt;code&gt;/include&lt;/code&gt; directories from our freebsd machine to our cross-build directory:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="n"&gt;mkdir&lt;/span&gt; -&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="nv"&gt;$TARGET_PREFIX&lt;/span&gt;{,&lt;span class="sr"&gt;/lib,/&lt;/span&gt;&lt;span class="n"&gt;include&lt;/span&gt;}
&lt;span class="c c-Singleline"&gt;# copy /lib and /include directories from our freebsd machine in our target $TARGET_PREFIX directory.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;GCC requires that a compiled copy of binutils be available for each targeted platform. So we need to download the source code of binutils and compile it for the freebsd machine.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ mkdir -p build-binutils
$ wget https://ftp.gnu.org/gnu/binutils/binutils-2.27.tar.gz
$ tar zxvf binutils-2.27.tar.gz
$ &lt;span class="nb"&gt;cd&lt;/span&gt; build-binutils
$ ../binutils-2.27/configure --target&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TARGET&lt;/span&gt; --prefix&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; -v
$ make -j 4
$ sudo make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;GCC also depends on the following components:
&lt;em&gt; GMP: GNU Multiple Precision Arithmetic Library
&lt;/em&gt; MPFR: GNU Multiple-precision floating-point rounding library
* MPC: GNU Multiple-precision C library&lt;/p&gt;
&lt;p&gt;To build our cross-compiler, we need to compile these dependencies but since these dependencies should produce code for our target machine, we need to build them for the host option set to our tagret (&lt;code&gt;--host=amd64-marcel-freebsd9.2&lt;/code&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ mkdir build-gmp
$ wget https://ftp.gnu.org/gnu/gmp/gmp-6.1.1.tar.xz
$ tar xvf gmp-6.1.1.tar.xz
$ &lt;span class="nb"&gt;cd&lt;/span&gt; build-gmp
$ ../gmp-6.1.1/configure --prefix&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --enable-shared --enable-static --enable-mpbsd --enable-fft --enable-cxx --host&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TARGET&lt;/span&gt;
$ make -j 4
$ sudo make install
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ..

$ mkdir build-mpfr
$ wget https://ftp.gnu.org/gnu/mpfr/mpfr-3.1.5.tar.xz
$ tar xvf mpfr-3.1.5.tar.xz
$ &lt;span class="nb"&gt;cd&lt;/span&gt; build-mpfr
$ ../mpfr-3.1.5/configure --prefix&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt;  --with-gnu-ld --with-gmp&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --enable-static --enable-shared --host&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TARGET&lt;/span&gt;
$ make -j 4
$ sudo make install
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ..

$ mkdir build-mpci
$ wget https://ftp.gnu.org/gnu/mpc/mpc-1.0.3.tar.gz
$ tar zxvf mpc-1.0.3.tar.gz
$ &lt;span class="nb"&gt;cd&lt;/span&gt; build-mpc
$ ../mpc-1.0.3/configure --prefix&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --with-gnu-ld --with-gmp&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --with-mpfr&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --enable-static --enable-shared --host&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TARGET&lt;/span&gt;
$ make -j 4
$ sudo make install
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ..
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Finally, to compile gcc we need to specify where to look for it's dependencies above:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ mkdir build-gcc
$ wget https://ftp.gnu.org/gnu/gcc/gcc-6.2.0/gcc-6.2.0.tar.gz
$ tar zxvf gcc-6.2.0.tar.gz
$ &lt;span class="nb"&gt;cd&lt;/span&gt; build-gcc
$ ../gcc-6.2.0/configure --without-headers --with-gnu-as --with-gnu-ld --enable-languages&lt;span class="o"&gt;=&lt;/span&gt;c,c++ --disable-nls --enable-libssp --enable-gold --enable-ld --target&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TARGET&lt;/span&gt; --prefix&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --with-gmp&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --with-mpc&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --with-mpfr&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --disable-libgomp
$ &lt;span class="nv"&gt;LD_LIBRARY_PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt;/lib make -j 4
$ sudo make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now, we should have our own cross-compiler's toolchain in &lt;code&gt;/usr/cross-build/bin&lt;/code&gt; directory. To use it we should include it in our &lt;code&gt;$PATH&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;export PATH=&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="x"&gt;:&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;PREFIX&lt;/span&gt;&lt;span class="x"&gt;/bin&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To test our own cross-compiler, we simply run:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ gcc main.c -o helloworld-linux
$ file helloword-linux
main: ELF 64-bit LSB executable, x86-64, version &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;SYSV&lt;span class="o"&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, &lt;span class="k"&gt;for&lt;/span&gt; GNU/Linux 2.6.32, BuildID&lt;span class="o"&gt;[&lt;/span&gt;sha1&lt;span class="o"&gt;]=&lt;/span&gt;ca5ba57ac722ef8521d50ee8ecbbdca4b44a76e1, not stripped
$ &lt;span class="nv"&gt;LD_LIBRARY_PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt;/lib amd64-marcel-freebsd9.2-gcc helloworld.c -o helloworld-freebsd
$ file helloworld-freebsd
main: ELF 64-bit LSB executable, x86-64, version &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;FreeBSD&lt;span class="o"&gt;)&lt;/span&gt;, dynamically linked, interpreter /libexec/ld-elf.so.1, &lt;span class="k"&gt;for&lt;/span&gt; FreeBSD 9.2, not stripped
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you need a cross-compile version of gdb, simply compile the gdb for the target machine like above:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ wget https://ftp.gnu.org/gnu/gdb/gdb-7.11.tar.xz
$ tar xvf gdb-7.11.tar.xz
$ ../gdb-7.11.1/configure --prefix&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PREFIX&lt;/span&gt; --target&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TARGET&lt;/span&gt;
$ make -j 4
$ sudo make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can see the whole compile process in my &lt;a href="https://gist.github.com/bijanebrahimi/62596745808f8667c40ff91b07d9e7b8"&gt;github gist&lt;/a&gt;.&lt;/p&gt;</content><category term="gist"></category><category term="gcc"></category><category term="cross-compiler"></category><category term="freebsd"></category><category term="linux"></category><category term="compiler"></category></entry><entry><title>Git Submodules</title><link href="http://bijanebrahimi.github.io/blog/git-submodules.html" rel="alternate"></link><published>2017-02-06T12:22:00+03:30</published><updated>2017-02-06T12:22:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2017-02-06:/blog/git-submodules.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;There are many good articles and blog posts on the Interenet describing how to migrate from svn to git repository. There are a lot of advantages to migrate to git, (&lt;a href="nvie.com/posts/a-successful-git-branching-model"&gt;git-flow&lt;/a&gt; to metion one) but there are also a few draw-backs. For example svn supports &lt;a href="http://svnbook.red-bean.com/en/1.7/svn.serverconfig.pathbasedauthz.html"&gt;Path-Based Authorization&lt;/a&gt; meaning great …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;There are many good articles and blog posts on the Interenet describing how to migrate from svn to git repository. There are a lot of advantages to migrate to git, (&lt;a href="nvie.com/posts/a-successful-git-branching-model"&gt;git-flow&lt;/a&gt; to metion one) but there are also a few draw-backs. For example svn supports &lt;a href="http://svnbook.red-bean.com/en/1.7/svn.serverconfig.pathbasedauthz.html"&gt;Path-Based Authorization&lt;/a&gt; meaning great control over who sees what parts of the project. Unfortunately git does not provide such mechanism meaning to overcome this task, we should split such files or directories into separate git repositories to restrict access per project and yet keep the project as a whole. In this post I explain how to use git submdules to do that.&lt;/p&gt;
&lt;h1&gt;Git-Flow using submodules&lt;/h1&gt;
&lt;p&gt;Imagine the following scenario in which we have a shared library named &lt;strong&gt;lib-shared&lt;/strong&gt; and two projects named &lt;strong&gt;protocol-x&lt;/strong&gt; and &lt;strong&gt;shell-y&lt;/strong&gt; which different developers have access to one of them.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ find . -type d
./libs/lib-shared
./routing/protocol-x
./cli/shell-y
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;What we're going to do is to create a separate git repository for each project (as sub-projects):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ mkdir lib-shared
$ &lt;span class="nb"&gt;cd&lt;/span&gt; lib-shared
$ git init
$ touch .gitignore
$ git add .
$ git commit -m &lt;span class="s2"&gt;&amp;quot;added .gitignore&amp;quot;&lt;/span&gt;
$ git remote add origin git@debian:root/lib-shared.git
$ git tag -a v0.1 -m v0.1
$ git push origin --all
$ git push --tags
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ..
$ mkdir protocol-x
$ &lt;span class="nb"&gt;cd&lt;/span&gt; protocol-x
$ git init
$ touch .gitignore
$ git add .
$ git commit -m &lt;span class="s2"&gt;&amp;quot;added .gitignore&amp;quot;&lt;/span&gt;
$ git remote add origin git@debian:root/protocol-x.git
$ git tag -a v0.1 -m v0.1
$ git push origin --all
$ git push --tags
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ..
$ mkdir shell-y
$ &lt;span class="nb"&gt;cd&lt;/span&gt; shell-y
$ git init
$ touch .gitignore
$ git add .
$ git commit -m &lt;span class="s2"&gt;&amp;quot;added .gitignore&amp;quot;&lt;/span&gt;
$ git remote add origin git@debian:root/shell-y.git
$ git tag -a v0.1 -m v0.1
$ git push origin --all
$ git push --tags
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ..
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And we create another project (super-project) containing these projects. To do that, we should add above sub-projects as submodules. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /home/manager/
$ mkdir super-project
$ &lt;span class="nb"&gt;cd&lt;/span&gt; super-project
$ git init
$ git remote add origin git@debian:root/super-project.git
$ git submodule add -b master --name lib-shared git@debian:root/lib-shared libs/lib-shared
$ git submodule add -b master --name protocol-x git@debian:root/protocol-x protocols/protocol-x
$ git submodule add -b master --name shell-y git@debian:root/shell-y cli/shell-y
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Running &lt;code&gt;git status&lt;/code&gt; we can see that git created a file named &lt;code&gt;.gitmodules&lt;/code&gt; which keeps a list of our current submodules. This file should be a part of source code and it'll help other people cloning this super-project to know which submodules they should also get using &lt;code&gt;git submodule init&lt;/code&gt; (if they have permission ofc). Also Git sees these sub-projects as files instead of directories. This is how git sees submodules. Each submodule points to a git commit SHA-1 which in our case is the latest commit in master branch of each-subproject. You can confirm this by running &lt;code&gt;git diff --staged&lt;/code&gt; command. More interestingly, we can see which version of submodules out super-project is following (before committing):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git submodule status
 fa75a2c38ed4b80f1c42e4434fd3d43e230605ba cli/shell-y &lt;span class="o"&gt;(&lt;/span&gt;v0.1&lt;span class="o"&gt;)&lt;/span&gt;
 9f0dd01bea1ec7f719bf17e2ff2018dc64fbe335 libs/lib-shared &lt;span class="o"&gt;(&lt;/span&gt;v0.1&lt;span class="o"&gt;)&lt;/span&gt;
 a2b7c92292a6b47a5ece5feea9e3390879d49d89 protocols/protocol-x &lt;span class="o"&gt;(&lt;/span&gt;v0.1&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we can commit the changes in our super-project:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git commit -m &lt;span class="s2"&gt;&amp;quot;added libshared, protocol-x and shell-y sub-projects&amp;quot;&lt;/span&gt;
$ git tag -a v0.1 -m &lt;span class="s2"&gt;&amp;quot;v0.1&amp;quot;&lt;/span&gt;
$ git push origin --all
$ git push --tags
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_01.svg"&gt;&lt;/p&gt;
&lt;p&gt;Now to follow our git-flow, we need to fork a new branch named &lt;strong&gt;dev&lt;/strong&gt; from master branch. What we should do  first is to create a dev branch in all of our sub-projects using &lt;code&gt;git submodule foreach&lt;/code&gt; which executes given commands in each of our (initialized) submodules:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /home/manager/projects/super-project
$ git checkout -b dev master
$ git submodule foreach &lt;span class="s1"&gt;&amp;#39;git pull origin master; git checkout -b dev master; $ $ git push origin dev&amp;#39;&lt;/span&gt;
$ sed -i&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;s/branch = master/branch = dev/g&amp;#39;&lt;/span&gt; .gitmodules
$ git add .gitmodules
$ git commit -m &lt;span class="s2"&gt;&amp;quot;forked dev branch&amp;quot;&lt;/span&gt;
$ git push origin dev
$ git tag -a v0.1-dev -m v0.1-dev
$ git push origin --tags
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_02.svg"&gt;&lt;/p&gt;
&lt;p&gt;Now it's time for our developers to clone the super project and changes some code. our developer &lt;strong&gt;kevin&lt;/strong&gt; is the maintainer of the shell-y and only have access to our shared library beside his project so he should avoid trying to get protocol-x project:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ make /home/kevin/projects/kevin-project
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ~/kevin/projects/kevin-project
$ git init
$ git remote add origin git@debian:root/super-project.git
$ git fetch origin
$ git checkout -b dev remotes/origin/dev
$ git submodule init cli/shell-y
$ git submodule init libs/lib-shared
$ git submodule update --remote
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_03.svg"&gt;&lt;/p&gt;
&lt;p&gt;To make a change in lib-shared, he needs to fork a new feature-branch from lib-shared's dev branch and simply pushes his branch to remote and notify the manager:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cd libs/lib-shared
git checkout -b feature-authors remotes/origin/dev
touch AUTHORS
git add AUTHORS
git commit -m &amp;quot;added AUTHORS file&amp;quot;
echo &amp;quot;bijan-e&amp;quot; &amp;gt; AUTHORS
git commit -a -m &amp;quot;added bijan-e to AUTHORS&amp;quot;
git push origin feature-authors
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: If kevin now goes to the root of his super-project, he sees that his super-project has changes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git submodule status
 fa75a2c38ed4b80f1c42e4434fd3d43e230605ba ../cli/shell-y &lt;span class="o"&gt;(&lt;/span&gt;v0.1&lt;span class="o"&gt;)&lt;/span&gt;
+51b9fbe3b08bc793193a70a48e762b4a5629514f lib-shared &lt;span class="o"&gt;(&lt;/span&gt;v0.1-2-g51b9fbe&lt;span class="o"&gt;)&lt;/span&gt;
-a2b7c92292a6b47a5ece5feea9e3390879d49d89 ../protocols/protocol-x
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_04.svg"&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;+&lt;/code&gt; sign beside lib-shared submodule shows that this subodule has changes which super-project does not added yet. the &lt;code&gt;-&lt;/code&gt; sign beside protocol-x submodule indictes that this module has not been initialized. Since his changes to lib-shared has not been accepted yet, he should revert update this submodule to point at the right hash commit which dev knows:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git submodule update
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_05.svg"&gt;&lt;/p&gt;
&lt;p&gt;Now The manager is notified and should review kevin's changes and decide if it's good enough to be merged into lib-shared's dev branch:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /home/manager/projects/super-project/libs/lib-shared
$ git pull origin
$ git tag -a v0.1-dev -m v0.1-dev
$ git checkout -b feature-authors remotes/origin/feature-authors
$ // Code Review
$ git checkout dev
$ git merge --no-ff feature-authors -m &lt;span class="s2"&gt;&amp;quot;merged feature authors&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_06.svg"&gt;&lt;/p&gt;
&lt;p&gt;Now lib-shared has reached v0.1-dev-3 should be included in super-project's dev branch:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /home/manager/projects/super-project
$ git submodule status
 fa75a2c38ed4b80f1c42e4434fd3d43e230605ba cli/shell-y &lt;span class="o"&gt;(&lt;/span&gt;v0.1&lt;span class="o"&gt;)&lt;/span&gt;
+04edc4cd6f3916f5d51a7f5cc7a6df92b11014a9 libs/lib-shared &lt;span class="o"&gt;(&lt;/span&gt;v0.1-dev-3-g04edc4c&lt;span class="o"&gt;)&lt;/span&gt;
 a2b7c92292a6b47a5ece5feea9e3390879d49d89 protocols/protocol-x &lt;span class="o"&gt;(&lt;/span&gt;v0.1&lt;span class="o"&gt;)&lt;/span&gt;
$ git diff --submodule
Submodule libs/lib-shared 9f0dd01..04edc4c:
  &amp;gt; merged feature authors
$ git add libs/lib-shared
$ git commit -m &lt;span class="s2"&gt;&amp;quot;merged lib-shared v0.1-dev-3&amp;quot;&lt;/span&gt;
$ git push origin dev --recurse-submodules&lt;span class="o"&gt;=&lt;/span&gt;on-demand
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The changes of lib-shared and super-project should can be send to their remotes manually for each project or only once from super-project using &lt;code&gt;--recurse-submodules&lt;/code&gt; argument. Note that push doesn't push submodule's tags so we need to push submodules's tags separately:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git submodule foreach &lt;span class="s1"&gt;&amp;#39;git push --tags&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_07.svg"&gt;&lt;/p&gt;
&lt;p&gt;Now kevin can fetch new changes in dev:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /home/kevin/projects/kevin-project
$ git pull origin dev
$ git submodule update --remote
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_08.svg"&gt;&lt;/p&gt;
&lt;p&gt;Merging branches in super-project is a little tricky. When merging dev branch into master, we should always check not to change &lt;code&gt;.gitmodules&lt;/code&gt; between merges. To do that we use &lt;code&gt;--no-commit&lt;/code&gt; argument just to do merge the, and before &lt;code&gt;git commit&lt;/code&gt; we should revert any changing comming from dev to master into &lt;code&gt;.gitmodules&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /home/manager/projects/super-project
$ git checkout master
$ git submodule update
$ git submodule foreach &lt;span class="s1"&gt;&amp;#39;git checkout master&amp;#39;&lt;/span&gt;
$ git merge --no-commit --no-ff dev
$ git reset HEAD .gitmodules
$ git checkout -- .gitmodules
$ git diff --submodule --staged
Submodule libs 9f0dd01..04edc4c:
  &amp;gt; merged feature authors
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The &lt;code&gt;git diff --submodule --staged&lt;/code&gt; shows which changes is going from submodules. We can use this commit messages to create a &lt;code&gt;CHANGELOG&lt;/code&gt; file. FInally before committing we should also merge submodules changes using &lt;code&gt;--merge&lt;/code&gt; argument:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git submodule update --merge
Updating 9f0dd01..04edc4c
Fast-forward
 AUTHORS &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; +
 &lt;span class="m"&gt;1&lt;/span&gt; file changed, &lt;span class="m"&gt;1&lt;/span&gt; insertion&lt;span class="o"&gt;(&lt;/span&gt;+&lt;span class="o"&gt;)&lt;/span&gt;
 create mode &lt;span class="m"&gt;100644&lt;/span&gt; AUTHORS
Submodule path &lt;span class="s1"&gt;&amp;#39;libs/lib-shared&amp;#39;&lt;/span&gt;: merged in &lt;span class="s1"&gt;&amp;#39;04edc4cd6f3916f5d51a7f5cc7a6df92b11014a9&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This confirms what the changes from dev's submodules are also merged into master's submodules. We should finalize this merge by committing changes and pushing both super-project and sub-project merge commits to remote:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git commit -m &lt;span class="s2"&gt;&amp;quot;merged v0.1-dev-1 into master&amp;quot;&lt;/span&gt;
$ git submodule foreach &lt;span class="s1"&gt;&amp;#39;git push origin master&amp;#39;&lt;/span&gt;
$ git push origin master
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image" src="/blog/assets/images/git_submodules_diagram_09.svg"&gt;&lt;/p&gt;</content><category term="git"></category><category term="svn"></category><category term="git submodules"></category></entry><entry><title>py3status Configuration</title><link href="http://bijanebrahimi.github.io/blog/py3status-configuration.html" rel="alternate"></link><published>2016-03-14T22:35:00+03:30</published><updated>2016-03-14T22:35:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2016-03-14:/blog/py3status-configuration.html</id><summary type="html">&lt;p&gt;Edited: Follow changes via my &lt;a href="https://github.com/bijanebrahimi/py3status-config"&gt;Github&lt;/a&gt; repository.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Screenshot&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt="py3status Configuration" src="https://bijanebrahimi.github.io/py3status-config/images/py3status.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Dependencies&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/ultrabug/py3status"&gt;py3status&lt;/a&gt; is an extensible i3status wrapper written in python.&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-flag"&gt;&lt;/i&gt; &lt;a href="https://fortawesome.github.io/Font-Awesome/"&gt;Font Awesome&lt;/a&gt;: Font Icons for i3-bar&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-camera"&gt;&lt;/i&gt; &lt;a href="https://github.com/naelstrof/maim"&gt;maim&lt;/a&gt;: a utility that takes screenshots of your desktop&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-lock"&gt;&lt;/i&gt; &lt;a href="http://i3wm.org/i3lock/"&gt;i3lock&lt;/a&gt;: is a simple screen locker like slock.&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-picture-o"&gt;&lt;/i&gt; &lt;a href="https://github.com/bijanebrahimi/waffle"&gt;waffle&lt;/a&gt;: to randomly download/change wallpaper.&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-calendar"&gt;&lt;/i&gt; &lt;a href="https://gahshomar.github.io/gahshomar/"&gt;gahshomar&lt;/a&gt; is a …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Edited: Follow changes via my &lt;a href="https://github.com/bijanebrahimi/py3status-config"&gt;Github&lt;/a&gt; repository.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Screenshot&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt="py3status Configuration" src="https://bijanebrahimi.github.io/py3status-config/images/py3status.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Dependencies&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/ultrabug/py3status"&gt;py3status&lt;/a&gt; is an extensible i3status wrapper written in python.&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-flag"&gt;&lt;/i&gt; &lt;a href="https://fortawesome.github.io/Font-Awesome/"&gt;Font Awesome&lt;/a&gt;: Font Icons for i3-bar&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-camera"&gt;&lt;/i&gt; &lt;a href="https://github.com/naelstrof/maim"&gt;maim&lt;/a&gt;: a utility that takes screenshots of your desktop&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-lock"&gt;&lt;/i&gt; &lt;a href="http://i3wm.org/i3lock/"&gt;i3lock&lt;/a&gt;: is a simple screen locker like slock.&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-picture-o"&gt;&lt;/i&gt; &lt;a href="https://github.com/bijanebrahimi/waffle"&gt;waffle&lt;/a&gt;: to randomly download/change wallpaper.&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-calendar"&gt;&lt;/i&gt; &lt;a href="https://gahshomar.github.io/gahshomar/"&gt;gahshomar&lt;/a&gt; is a calendar with simplicity in design and elegance in execution.&lt;/li&gt;
&lt;li&gt;&lt;i class="fa fa-music"&gt;&lt;/i&gt; &lt;a href="http://audacious-media-player.org/"&gt;audacious&lt;/a&gt; Music Player (needs qdbus and audacious mpris plugins installed).&lt;/li&gt;
&lt;/ul&gt;</content><category term="linux"></category><category term="i3"></category><category term="py3status"></category><category term="i3status"></category><category term="font-awesome"></category></entry><entry><title>Books I Read in 2015</title><link href="http://bijanebrahimi.github.io/blog/books-i-read-in-2015.html" rel="alternate"></link><published>2016-03-13T12:09:00+03:30</published><updated>2016-03-13T12:09:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2016-03-13:/blog/books-i-read-in-2015.html</id><summary type="html">&lt;p&gt;The List isn't long. in fact I spend the entire year in a military camp doing my
final year of military service. my resolution for the year to read Books
I wished to read but didn't have the time and I enjoyed reading every one of them.&lt;/p&gt;
&lt;h2&gt;Novels&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Divergent Series …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;The List isn't long. in fact I spend the entire year in a military camp doing my
final year of military service. my resolution for the year to read Books
I wished to read but didn't have the time and I enjoyed reading every one of them.&lt;/p&gt;
&lt;h2&gt;Novels&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Divergent Series by Veronica Roth&lt;/li&gt;
&lt;li&gt;Lord of the Rings by J.R.R Tolkien&lt;/li&gt;
&lt;li&gt;Inferno by Dan Brown&lt;/li&gt;
&lt;li&gt;The Lost Symbol by Dan Brown&lt;/li&gt;
&lt;li&gt;Beloved by Toni Morrison&lt;/li&gt;
&lt;li&gt;The Fault in our starts by John Green&lt;/li&gt;
&lt;li&gt;The Abundance of Katherines by John Green&lt;/li&gt;
&lt;li&gt;The First Man by Albert Camus&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Computer &amp;amp; Programming&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Clean Code by Robert C. Martin&lt;/li&gt;
&lt;li&gt;Effective Python by Brett Slatkin&lt;/li&gt;
&lt;li&gt;Pro Git by Scott Chacon&lt;/li&gt;
&lt;/ul&gt;</content><category term="Book"></category><category term="Divergent"></category><category term="Insurgent"></category><category term="Allegiant"></category><category term="Veronica Roth"></category><category term="Lord of the Rings"></category><category term="J.R.R Tolkien"></category><category term="Dan Brown"></category><category term="Lost Symbol"></category><category term="Inferno"></category><category term="Beloved"></category><category term="Toni Morrison"></category><category term="The fault in our stars"></category><category term="The Abundance of Katherines"></category><category term="John Green"></category><category term="The first man"></category><category term="Albert Camus"></category><category term="Clean Code"></category><category term="Robert C. Martin"></category><category term="Effective Python"></category><category term="Brett Slatkin"></category><category term="Pro Git"></category><category term="Scott Chacon"></category></entry><entry><title>A dropdown Tiling Terminal for i3-wm</title><link href="http://bijanebrahimi.github.io/blog/a-dropdown-tiling-terminal-for-i3-wm.html" rel="alternate"></link><published>2016-02-27T14:27:00+03:30</published><updated>2016-02-27T14:27:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2016-02-27:/blog/a-dropdown-tiling-terminal-for-i3-wm.html</id><summary type="html">&lt;p&gt;&lt;a href="http://i3wm.org/docs/userguide.html#_scratchpad"&gt;Scratchpad&lt;/a&gt; is one of the
coolest, and unique features in &lt;a href="http://i3wm.org"&gt;i3&lt;/a&gt;. Scratchpad is basically a
hidden workspace that you can send your programs into it.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There is no way to open that workspace. Instead, when using &lt;code&gt;scratchpad show&lt;/code&gt;,
the window will be shown again, as a floating window, centered on …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://i3wm.org/docs/userguide.html#_scratchpad"&gt;Scratchpad&lt;/a&gt; is one of the
coolest, and unique features in &lt;a href="http://i3wm.org"&gt;i3&lt;/a&gt;. Scratchpad is basically a
hidden workspace that you can send your programs into it.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There is no way to open that workspace. Instead, when using &lt;code&gt;scratchpad show&lt;/code&gt;,
the window will be shown again, as a floating window, centered on your current
workspace&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Using scratchpad, we can turn any terminal into a drop-down terminal. I'm using &lt;a href="http://www.tenshu.net/p/terminator.html"&gt;terminator&lt;/a&gt; which supports tiling (and more)
and &lt;code&gt;F1&lt;/code&gt; key as hot key to toggle terminator since I have no other use for formally
known help button key on linux.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Add this to your i3 config (~/.config/i3/config) and restart i3 (Super+Shift+R)
exec --no-startup-id &amp;quot;terminator -m&amp;quot;
for_window [class=&amp;quot;Terminator&amp;quot; title=&amp;quot;^((?!Terminator Preferences).)*$&amp;quot;] move scratchpad, move position 0 0, resize set 1366 768;
bindsym F1 [class=&amp;quot;Terminator&amp;quot;] scratchpad show;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can also view the changes via &lt;a href="https://gist.github.com/bijanebrahimi/6641e8022dffb2e6a5dd"&gt;Github Gist&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: It's possible to send other programs into scratchpad workspace, and
toggle them using different key bindings. The trick is to exclude &lt;strong&gt;Terminator&lt;/strong&gt;
which is also in Scratchpad from showing. for example, Using the code below we
can simply send any active programs into Scratchpad using &lt;code&gt;Super+Shift+F1&lt;/code&gt; key
and retrieve them one by one by hitting &lt;code&gt;Super+F1&lt;/code&gt; and only by pressing &lt;code&gt;F1&lt;/code&gt; we
can toggle &lt;strong&gt;Terminator&lt;/strong&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;bindsym &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;mod&lt;/span&gt;&lt;span class="x"&gt;+Shift+F1 move container to scratchpad&lt;/span&gt;
&lt;span class="x"&gt;bindsym &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;mod&lt;/span&gt;&lt;span class="x"&gt;+F1 [class=&amp;quot;^((?!Terminator).)*&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="x"&gt;&amp;quot;] scratchpad show&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="linux"></category><category term="terminal"></category><category term="terminator"></category><category term="i3"></category><category term="scratchpad"></category></entry><entry><title>rofi-todo</title><link href="http://bijanebrahimi.github.io/blog/rofi-todo.html" rel="alternate"></link><published>2016-02-26T18:15:00+03:30</published><updated>2016-02-26T18:15:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2016-02-26:/blog/rofi-todo.html</id><summary type="html">&lt;p&gt;If you're unfamiliar with &lt;a href="https://davedavenport.github.io/rofi/"&gt;rofi&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;It's a popup window switcher roughly based on &lt;a href="http://code.google.com/p/superswitcher/"&gt;superswitcher&lt;/a&gt;,
requiring only xlib and pango&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Rofi has multiple modes.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;RUN&lt;/strong&gt;: Shows a list of executables in $PATH and can launch them (optional in a terminal).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DRUN&lt;/strong&gt;: Same as the run launches, but the list is created …&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;p&gt;If you're unfamiliar with &lt;a href="https://davedavenport.github.io/rofi/"&gt;rofi&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;It's a popup window switcher roughly based on &lt;a href="http://code.google.com/p/superswitcher/"&gt;superswitcher&lt;/a&gt;,
requiring only xlib and pango&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Rofi has multiple modes.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;RUN&lt;/strong&gt;: Shows a list of executables in $PATH and can launch them (optional in a terminal).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DRUN&lt;/strong&gt;: Same as the run launches, but the list is created from the installed desktop files.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Window&lt;/strong&gt;: Show a list of all the windows and allow switching between them.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;WindowCD&lt;/strong&gt;: Shows a list of the windows on the current desktop and allows switching between them.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SSH&lt;/strong&gt;: Shows a list of SSH targets based on your ssh config file, and allows to quickly ssh into them.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Script&lt;/strong&gt;: Allows custom scripted Modi to be added.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Using &lt;code&gt;script&lt;/code&gt; mode, one can extend the rofi. There are plenty scripts
other there. you should definitely check &lt;a href="https://davedavenport.github.io/rofi/p07-Scripts.html"&gt;them&lt;/a&gt; out.&lt;/p&gt;
&lt;h2&gt;TODO List Script&lt;/h2&gt;
&lt;p&gt;Script modi can be enabled using &lt;code&gt;name:script&lt;/code&gt; syntax. Just save the following
script somewhere in your &lt;code&gt;PATH&lt;/code&gt; directory like &lt;code&gt;/usr/local/bin&lt;/code&gt;, make sure it's
executable and run the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rofi -modi TODO:/usr/local/bin/rofi_todo.sh -key-todo SuperL+t
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="rofi-todo" src="http://bijanebrahimi.github.io/blog/assets/images/rofi_todolist-rofi_todo.png"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;TODO_FILE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;~/.rofi_todos

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; ! -a &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO_FILE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
    touch &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO_FILE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;fi&lt;/span&gt;

&lt;span class="k"&gt;function&lt;/span&gt; list_todos&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nv"&gt;TODO&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;cat &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO_FILE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; -z &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="nv"&gt;TODDO&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;fi&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; -z &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;then&lt;/span&gt;
    list_todos
&lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="nv"&gt;TODO&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed &lt;span class="s2"&gt;&amp;quot;s/\([^a-zA-Z0-9]\)/\\\\\\1/g&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
    &lt;span class="nv"&gt;TODO_UNSCAPED&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;

    &lt;span class="nv"&gt;MATCHING&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;grep &lt;span class="s2"&gt;&amp;quot;^&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;$&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO_FILE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;MATCHING&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        sed -i &lt;span class="s2"&gt;&amp;quot;/^&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;$&lt;span class="s2"&gt;/d&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO_FILE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;`date +&amp;quot;&lt;/span&gt;%B %d %H:%M&lt;span class="s2"&gt;&amp;quot;` &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO_UNSCAPED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TODO_FILE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;fi&lt;/span&gt;
    list_todos
&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;Instructions&lt;/strong&gt;:
- To &lt;strong&gt;Add new TODO&lt;/strong&gt;, just type it (It should be Unique, BTW) at TODO prompt
- To &lt;strong&gt;Delete one&lt;/strong&gt;, Just Select the one and hit Enter&lt;/p&gt;
&lt;p&gt;If you're already using rofi, just add &lt;code&gt;TODO&lt;/code&gt; modi to your existing command-line:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rofi -modi DRun,Run,Window,TODO:/usr/local/bin/rofi_todo.sh -key-todo SuperL+t -show TODO
&lt;/pre&gt;&lt;/div&gt;</content><category term="linux"></category><category term="rofi"></category><category term="rofi-todo"></category><category term="rofi-script"></category><category term="bash"></category><category term="project"></category></entry><entry><title>Extending The Battery Life in Linux</title><link href="http://bijanebrahimi.github.io/blog/extending-the-battery-life-in-linux.html" rel="alternate"></link><published>2016-02-25T14:20:00+03:30</published><updated>2016-02-25T14:20:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2016-02-25:/blog/extending-the-battery-life-in-linux.html</id><summary type="html">&lt;p&gt;Before Running any tunning, the average estimated lifetime of my battery was
about 3 hours (below image). Through this post we learn how to extend it to
almost 4 and a half hours. It's more than 50 percent increase!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: I'm currently using a lenovo G50 laptop with Quad-Core AMD …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;Before Running any tunning, the average estimated lifetime of my battery was
about 3 hours (below image). Through this post we learn how to extend it to
almost 4 and a half hours. It's more than 50 percent increase!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: I'm currently using a lenovo G50 laptop with Quad-Core AMD CPU equiped
with a 4-cell battery and running &lt;code&gt;i3-wm&lt;/code&gt;, a lightweight tilling window manager
(no Gnome/KDE craps for me) on ArchLinux.
So depending on your hardware and programs you have running and your daily usage
pattern, the results may vary for you.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt="Gnome Battery Bench" src="http://bijanebrahimi.github.io/blog/assets/images/extend_linux_battery_life-battery_bench_before_tunning.png" title="Gnome Battery Bench - Before Tunning"&gt;&lt;/p&gt;
&lt;p&gt;First, run &lt;code&gt;powertop&lt;/code&gt; to find out which devices/processes are draining power the most.
In The &lt;code&gt;Overview Tab&lt;/code&gt; you can actually see what processes/devices are draining
how much power and By applying the Good option in &lt;code&gt;Tunables Tab&lt;/code&gt;, powertop
automatically tunes them. you can do this manually for every item in Tunable tab
or just use the &lt;code&gt;--auto-tune&lt;/code&gt; option.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo powertop --auto-tune
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That single command will probably add a noticeable extra minutes to your battery
life. But there are still other ways to improve it more. Let's Go to powertop's
&lt;code&gt;Overview Tab&lt;/code&gt; again:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Power est.  Usage        Events/s    Category    Description
  5.18 W    0.4 pkts/s               Device      Network interface: wlp2s0 (wl)
  3.80 W    100.0%                   Device      Display backlight
  1.26 W    165.5 ms/s   123.3       Process     /usr/share/atom/atom --type=zygote --no-sandbox
  675 mW    95.9 ms/s    5.3         Process     atom
  660 mW    94.0%                    Device      USB device: USB2.0-CRW (Generic)
  262 mW    27.0 ms/s    90.1        Process     /usr/share/atom/atom --executed-from=/home/bijan --pid=1109
  247 mW    27.2 ms/s    70.4        Process     /usr/lib/xorg-server/Xorg :0 -seat seat0 -auth /run/lightdm/root/:0 -nolisten tc
  103 mW    2.0 ms/s     109.7        kWork      od_dbs_timer
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;According to above, after my wireless interface (which i use), the display backlight,
USB CD-RW and my Ethernet interface are the most draining power sources.
The last two I never/rarely use.&lt;/p&gt;
&lt;h3&gt;Turning Off unnecessary devices&lt;/h3&gt;
&lt;p&gt;Since I never/rarely use my CD-RW and I never connect to Internet through wired
connection, so it seems logical to me to disable them. to find my CD-RW device
power location, I used powertop &lt;code&gt;Tunable Tab&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Disable CR-RW
$ echo 0 | s tee /sys/bus/usb/devices/1-1.3/power/autosuspend_delay_ms
$ echo auto | s tee /sys/bus/usb/devices/1-1.3/power/control
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To disable my Ethernet device, first I have to find it's device number:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Find Ethernet domain:bus:slot number
$ lspci | grep -i ethernet
03:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8111/8168/8411 PCI Express Gigabit Ethernet Controller (rev 10)

# Find relative device on /sys/devices
$ find /sys/devices -name &amp;quot;*03:00.0&amp;quot;
/sys/devices/pci0000:00/0000:00:02.4/0000:03:00.0

# Turn off device
echo 1 | s tee /sys/devices/pci0000:00/0000:00:02.4/0000:03:00.0/remove
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Backlight&lt;/h3&gt;
&lt;p&gt;To reduce the brightness LED backlight, I set a brightness value (between 0 and 255):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="x"&gt; Brightness&lt;/span&gt;
&lt;span class="x"&gt;basedir=&amp;quot;/sys/class/backlight/&amp;quot;&lt;/span&gt;
&lt;span class="x"&gt;handler=&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;basedir&lt;/span&gt;&lt;span class="p"&gt;$(&lt;/span&gt;&lt;span class="err"&gt;ls&lt;/span&gt; &lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;basedir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="x"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;

&lt;span class="x"&gt;chmod 666 &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;handler&lt;/span&gt;&lt;span class="x"&gt;/brightness&lt;/span&gt;
&lt;span class="x"&gt;echo 100 &amp;gt; handler/brightness&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Running as a Service&lt;/h1&gt;
&lt;p&gt;To execute the above commands at boot up, I created a shell script and run that
as a service.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;# /usr/local/bin/powertop_tuning.sh&lt;/span&gt;

&lt;span class="c1"&gt;# Auto-tune powertop&lt;/span&gt;
powertop --auto-tune

&lt;span class="c1"&gt;# Disable CR-RW&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; s tee /sys/bus/usb/devices/1-1.3/power/autosuspend_delay_ms
&lt;span class="nb"&gt;echo&lt;/span&gt; auto &lt;span class="p"&gt;|&lt;/span&gt; s tee /sys/bus/usb/devices/1-1.3/power/control

&lt;span class="c1"&gt;# Disable Ethernet&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; s tee /sys/devices/pci0000:00/0000:00:02.4/0000:03:00.0/remove

&lt;span class="c1"&gt;# Brightness&lt;/span&gt;
chmod &lt;span class="m"&gt;666&lt;/span&gt; /sys/class/backlight/radeon_bl0/brightness
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="m"&gt;80&lt;/span&gt; &amp;gt; /sys/class/backlight/radeon_bl0/brightness
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;And to create proper systemd service:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# /etc/systemd/system/powertop_tuning.service
[Unit]
Description=&amp;quot;PowerTop Tuning config&amp;quot;
ConditionPathExists=/usr/local/bin/powertop_tuning.sh

[Service]
Type=oneshot
RemainAfterExit=yes
KillMode=none
ExecStart=/usr/local/bin/powertop_tuning.sh
ExecStop=exit

[Install]
WantedBy=multi-user.target
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So, to make &lt;code&gt;powertop_tuning&lt;/code&gt; service run automatically, just enable the service:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; powertop_tuning.service
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;The result is very satisfactory. In daily usage, my battery life went up
from about 3 hours to almost 4 and a half hours.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Gnome Battery Bench" src="http://bijanebrahimi.github.io/blog/assets/images/extend_linux_battery_life-battery_bench_after_tunning.png" title="Gnome Battery Bench - After Tunning"&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Disclaimer&lt;/strong&gt;: The tests and battery benchmark did not placed in a controlled
environment but it seems logical to expect similar effects.&lt;/p&gt;
&lt;/blockquote&gt;</content><category term="linux"></category><category term="powertop"></category><category term="power"></category></entry><entry><title>Multiseat Linux Desktop, Multiple X servers</title><link href="http://bijanebrahimi.github.io/blog/multiseat-linux-desktop-multiple-x-servers.html" rel="alternate"></link><published>2014-10-22T10:35:00+03:30</published><updated>2014-10-22T10:35:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2014-10-22:/blog/multiseat-linux-desktop-multiple-x-servers.html</id><summary type="html">&lt;p&gt;This is the first solution in the main Article &lt;a href="{filename}/multiseat-linux-desktop.md"&gt;Multiseat Linux Desktop&lt;/a&gt;. you may also find other solutions for multiseat configuration in there as well.&lt;/p&gt;
&lt;h3&gt;Hardware Requirements&lt;/h3&gt;
&lt;p&gt;for each user, we need seperate:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mouse&lt;/li&gt;
&lt;li&gt;keyboard&lt;/li&gt;
&lt;li&gt;monitor&lt;/li&gt;
&lt;li&gt;Video Card&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;each Monitor will be attached to a seperate Video Card.&lt;/p&gt;
&lt;h3&gt;Introduction&lt;/h3&gt;
&lt;p&gt;the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;This is the first solution in the main Article &lt;a href="{filename}/multiseat-linux-desktop.md"&gt;Multiseat Linux Desktop&lt;/a&gt;. you may also find other solutions for multiseat configuration in there as well.&lt;/p&gt;
&lt;h3&gt;Hardware Requirements&lt;/h3&gt;
&lt;p&gt;for each user, we need seperate:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mouse&lt;/li&gt;
&lt;li&gt;keyboard&lt;/li&gt;
&lt;li&gt;monitor&lt;/li&gt;
&lt;li&gt;Video Card&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;each Monitor will be attached to a seperate Video Card.&lt;/p&gt;
&lt;h3&gt;Introduction&lt;/h3&gt;
&lt;p&gt;the &lt;a href="https://en.wikipedia.org/wiki/X_Window_System"&gt;X Window System&lt;/a&gt; is a system program which implements the hardware layer and the basis for graphical user interfaces (GUIs). to run seperate Desktop Environment in linux, we need to run seperate X servers as well. each X server will use separate Video card, Mouse and Keyboard (input devices). for that we have to configure the X server to do that. but first we have to identify the devices we have plugged to the computer to address them later in the X configuration file.
&lt;!-- BREAK --&gt;&lt;/p&gt;
&lt;h3&gt;Hardware Detection&lt;/h3&gt;
&lt;p&gt;we can find our input devices (Mouse &amp;amp; Keyboards) in &lt;code&gt;/dev/input&lt;/code&gt; directory. lets look to see what have we here:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ls -la /dev/input
drwxr-xr-x  &lt;span class="m"&gt;4&lt;/span&gt; root root    &lt;span class="m"&gt;320&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 .
drwxr-xr-x &lt;span class="m"&gt;15&lt;/span&gt; root root   &lt;span class="m"&gt;3060&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:59 ..
drwxr-xr-x  &lt;span class="m"&gt;2&lt;/span&gt; root root    &lt;span class="m"&gt;160&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 by-id
drwxr-xr-x  &lt;span class="m"&gt;2&lt;/span&gt; root root    &lt;span class="m"&gt;220&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 by-path
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;64&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event0
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;65&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event1
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;66&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event2
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;67&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event3
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;68&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event4
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;69&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event5
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;70&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event6
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;71&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event7
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;72&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 event8
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;63&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 mice
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;32&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 mouse0
crw-------  &lt;span class="m"&gt;1&lt;/span&gt; root root 13, &lt;span class="m"&gt;33&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 mouse1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;before explaining what is each of these files and directories, first we have to look at their permissions. they belogs to root user and group. so for reading them, we have to have read permission. run the below commands as super user or just run them using the &lt;code&gt;sudo&lt;/code&gt; command which i did.&lt;/p&gt;
&lt;p&gt;each &lt;code&gt;/dev/input/event*&lt;/code&gt; file is an input device file. to find out which one is related to which input device we can print the files and see if it contains output when we move our mouse or press a key. so i did run the command and played with my input devices to see which one is which.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo cat /dev/input/event0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;do this till you find all of your input devices.&lt;/p&gt;
&lt;p&gt;an alternative way (which i preffer) is to look into &lt;code&gt;/dev/input/by-id/&lt;/code&gt; directory. your Input devices should be listed there with their human readable names.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ls -la /dev/input/by-id/
drwxr-xr-x &lt;span class="m"&gt;2&lt;/span&gt; root root &lt;span class="m"&gt;160&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 .
drwxr-xr-x &lt;span class="m"&gt;2&lt;/span&gt; root root &lt;span class="m"&gt;160&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 .
drwxr-xr-x &lt;span class="m"&gt;4&lt;/span&gt; root root &lt;span class="m"&gt;320&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 ..
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root   &lt;span class="m"&gt;9&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 usb-15ca_USB_Optical_Mouse-event-mouse -&amp;gt; ../event2
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root   &lt;span class="m"&gt;9&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 usb-15ca_USB_Optical_Mouse-mouse -&amp;gt; ../mouse0
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root   &lt;span class="m"&gt;9&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 usb-CHICONY_USB_Keyboard-event-if01 -&amp;gt; ../event4
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root   &lt;span class="m"&gt;9&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 usb-CHICONY_USB_Keyboard-event-kbd -&amp;gt; ../event3
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root   &lt;span class="m"&gt;9&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 usb-Logitech_Logitech_USB_Keyboard-event-if01 -&amp;gt; ../event1
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root   &lt;span class="m"&gt;9&lt;/span&gt; Apr &lt;span class="m"&gt;23&lt;/span&gt; 09:57 usb-Logitech_Logitech_USB_Keyboard-event-kbd -&amp;gt; ../event0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;since you may notice, there may be a lot more input devices there. that's because linux will create several input device files for devices like Keyboards which have fancy buttons. try the old &lt;code&gt;cat&lt;/code&gt; command to find out which one is your proper device driver file. i did it this way:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo cat /dev/input/by-id/usb-15ca_USB_Optical_Mouse-event-mouse
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;write your input device names with their related device file name somewhere cause we're going to need those later.&lt;/p&gt;
&lt;p&gt;at last for Video Cards. Video cards are identified by their address on the PCI bus. so to find them we can use &lt;code&gt;lspci&lt;/code&gt; command.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ lspci &lt;span class="p"&gt;|&lt;/span&gt;  grep VGA
00:09.0 VGA compatible controller: nVidia Corporation NV18 &lt;span class="o"&gt;[&lt;/span&gt;GeForce4 MX &lt;span class="m"&gt;4000&lt;/span&gt; AGP 8x&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;rev c1&lt;span class="o"&gt;)&lt;/span&gt;
00:0a.0 VGA compatible controller: nVidia Corporation NV18 &lt;span class="o"&gt;[&lt;/span&gt;GeForce4 MX &lt;span class="m"&gt;4000&lt;/span&gt; AGP 8x&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;rev c1&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;this command lists the pci devices connected to the computer and filters the lines containing VGA. the number on the left is the device PCI address. now we have the table below for our multiseat configuration:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Seat number one&lt;/li&gt;
&lt;li&gt;mouse: /dev/input/event2&lt;/li&gt;
&lt;li&gt;keyboard: /dev/input/event0&lt;/li&gt;
&lt;li&gt;Video Card: 00:09.0&lt;/li&gt;
&lt;li&gt;Seat number two&lt;/li&gt;
&lt;li&gt;mouse: /dev/input/event8&lt;/li&gt;
&lt;li&gt;keyboard: /dev/input/event3&lt;/li&gt;
&lt;li&gt;Video Card: /dev/input/event8&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;X Configuration&lt;/h3&gt;
&lt;p&gt;the X keeps it's configuration file in &lt;code&gt;/etc/X11&lt;/code&gt; directory. we can directly modify it's current configuration file &lt;code&gt;xorg.conf&lt;/code&gt; or we can simply create an alternative configuration file and tell X to read from it manually. that will help us to run X with default configurations if our configuration somehow didn't work.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo touch /etc/X11/xorg.conf.multiseat
$ sudo nano xorg.conf.multiseat
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;First of all, we need to set &lt;a href="https://wiki.archlinux.org/index.php/Xorg_multiseat#The_basics"&gt;basic Xorg configuration&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Section &amp;quot;ServerFlags&amp;quot;
    Option &amp;quot;AutoAddDevices&amp;quot;     &amp;quot;false&amp;quot;
    Option &amp;quot;AutoEnableDevices&amp;quot;  &amp;quot;false&amp;quot;
    Option &amp;quot;AllowMouseOpenFail&amp;quot; &amp;quot;on&amp;quot;
    Option &amp;quot;AllowEmptyInput&amp;quot; &amp;quot;on&amp;quot;
    Option &amp;quot;ZapWarning&amp;quot;         &amp;quot;on&amp;quot;
    Option &amp;quot;HandleSpecialKeys&amp;quot;  &amp;quot;off&amp;quot; # Zapping on
    Option &amp;quot;DRI2&amp;quot; &amp;quot;on&amp;quot;
    Option &amp;quot;Xinerama&amp;quot; &amp;quot;off&amp;quot;
EndSection
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;after that we need to define input devices, screens, monitors and layouts. do the following configuration for each seat you want to have. so first we need to define out input devices. look at the "Option Device". it is the device file name we detect earlier:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Section &amp;quot;InputDevice&amp;quot;
    Identifier      &amp;quot;Keyboard0&amp;quot;
    Driver          &amp;quot;evdev&amp;quot;
    Option          &amp;quot;Device&amp;quot;                &amp;quot;/dev/input/event0&amp;quot;
    Option &amp;quot;xkb_rules&amp;quot; &amp;quot;evdev&amp;quot;
    Option &amp;quot;xkb_model&amp;quot; &amp;quot;evdev&amp;quot;
    Option &amp;quot;xkb_layout&amp;quot; &amp;quot;us&amp;quot;
    Option &amp;quot;GrabDevice&amp;quot; &amp;quot;on&amp;quot; # prevent send event to other X-servers
EndSection
Section &amp;quot;InputDevice&amp;quot;
    Identifier &amp;quot;Mouse0&amp;quot;
    Driver &amp;quot;evdev&amp;quot;
    Option &amp;quot;Device&amp;quot; &amp;quot;/dev/input/event2&amp;quot;
    Option &amp;quot;GrabDevice&amp;quot; &amp;quot;on&amp;quot;
EndSection
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;now we need to define Screen with uses Monitor and Device which is our Video Card (you can tweak the Modes and ... if you like). the BusId Option is the PCI address we also found earlier.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Section &amp;quot;Device&amp;quot;
    Identifier      &amp;quot;Nvidia0&amp;quot;
    Driver          &amp;quot;nouveau&amp;quot;
    BusId           &amp;quot;PCI:00:09.0&amp;quot;
EndSection
    Section &amp;quot;Monitor&amp;quot;
    Identifier      &amp;quot;Lg0&amp;quot;
    HorizSync       30-93
    VertRefresh     60
    Option          &amp;quot;dpms&amp;quot;
EndSection
Section &amp;quot;Screen&amp;quot;
    Identifier              &amp;quot;Screen0&amp;quot;
    Device                  &amp;quot;Nvidia0&amp;quot;
    Monitor                 &amp;quot;Lg0&amp;quot;
    DefaultDepth    24
    Option                  &amp;quot;DPI&amp;quot;   &amp;quot;100x100&amp;quot;
    Subsection &amp;quot;Display&amp;quot;
        Depth   24
        Modes   &amp;quot;1280x1024&amp;quot;     &amp;quot;1024x768&amp;quot;
    EndSubsection
EndSection
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and finally, we need to define a Layout which we will later tell X to load it. it simply gathers the defined input devices and Screens.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Section &amp;quot;ServerLayout&amp;quot;
    Identifier      &amp;quot;Seat0&amp;quot;
    Screen          1               &amp;quot;Screen0&amp;quot;       1                   1
    InputDevice     &amp;quot;Mouse0&amp;quot;        &amp;quot;CorePointer&amp;quot;
    InputDevice     &amp;quot;keyboard0&amp;quot;      &amp;quot;CoreKeyboard&amp;quot;
    Option &amp;quot;Clone&amp;quot; &amp;quot;off&amp;quot;
    Option &amp;quot;AutoAddDevices&amp;quot; &amp;quot;off&amp;quot;
    Option &amp;quot;DisableModInDev&amp;quot; &amp;quot;true&amp;quot;
    Option &amp;quot;SingleCard&amp;quot; &amp;quot;on&amp;quot;   # use this to simplfied isolatedevice option
EndSection
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;that's it. do this process again for the next seats and then you're done.&lt;/p&gt;
&lt;h3&gt;Test The Configuration&lt;/h3&gt;
&lt;p&gt;to test if everything is OK, we can run X using our multiseat configuration file and defined Layout. so we need to tell X where to look for COnfiguration file and load Which layout.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ startx -- :1 -layout Seat0 -config xorg.conf.multiseat
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;in the above code, i used &lt;code&gt;startx&lt;/code&gt;. it is a front-end script to xinit. you can also simply run the X directly:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ X -novtswitch -sharevts -nolisten tcp -config xorg.conf.multiseat -layout Seat0 :1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;you may need to go to the 7th console to use it (CTRL+F7) as the second seat will be available on the 8th console and so on.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ startx -- :2 -layout Seat0 -config xorg.conf.multiseat
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;if anything happend,read the log files and search the web.&lt;/p&gt;
&lt;h3&gt;Configure Display Managers&lt;/h3&gt;
&lt;p&gt;it is possible to configure your Display Manager (like KDM or GDM) to behave properly with Multiseat configuration at boot-up, but since i dont use any Display Manager, i can not tell you exactly how to do it. search the web for that matter. you can do it the easy way by configuring your Display Manager rc file or the hard way by editing the &lt;code&gt;/etc/inittab&lt;/code&gt; file if you have systemV.&lt;/p&gt;</content><category term="X11"></category><category term="config"></category><category term="xephyr"></category></entry><entry><title>Multiseat Linux Desktop</title><link href="http://bijanebrahimi.github.io/blog/multiseat-linux-desktop.html" rel="alternate"></link><published>2014-10-21T10:35:00+03:30</published><updated>2014-10-21T10:35:00+03:30</updated><author><name>Bijan</name></author><id>tag:bijanebrahimi.github.io,2014-10-21:/blog/multiseat-linux-desktop.html</id><summary type="html">&lt;p&gt;here is the story. my 3 years old nephew (which i love him so much) is so curious about computers. every time he comes to visit (which is not rarely), he insist on helping me with my computer works. of course he thinks he is helping but i can't have …&lt;/p&gt;</summary><content type="html">&lt;p&gt;here is the story. my 3 years old nephew (which i love him so much) is so curious about computers. every time he comes to visit (which is not rarely), he insist on helping me with my computer works. of course he thinks he is helping but i can't have him messing my projects. so i wondered if i can (peacefully) share the computer with him. i searched and i found out about &lt;a href="en.wikipedia.org/wiki/Multiseat_configuration"&gt;Multiseat&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A multiseat, multi-station or multiterminal configuration is a single computer which supports
multiple independent local users at the same time. In modern usage the terms refer to multiple
users using one personal computer, each with their own console, consisting of a keyboard a mouse,
a monitor, and possibly headphones --Wikipedia&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;so obviously that was the solution. time to get my hands dirty on the code :)&lt;/p&gt;
&lt;h3&gt;GNU/Linux Solutions&lt;/h3&gt;
&lt;p&gt;as it may be obvious, there are numbers of solution to do configure the GNU/Linux system to fit my need. so, in the following next articles (below links), i will explain these solution as i experienced them. i try to do them separately and independently, so you can skip ones you are not interested about. here are what i found:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="{filename}/multiseat-linux-desktop-multiple-x-servers.md"&gt;Multiple X servers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Nested X servers (i will write about it very soon)&lt;/li&gt;
&lt;li&gt;The Multi-seat display manager&lt;/li&gt;
&lt;/ol&gt;</content><category term="X11"></category><category term="config"></category></entry></feed>